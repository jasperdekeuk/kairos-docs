<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Unlocking the Mysteries of Trusted Boot: A Deep Dive into Secure System Boot Processes | Kairos</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kairos.io/kairos-docs/img/Kairos_800x419.png"><meta data-rh="true" name="twitter:image" content="https://kairos.io/kairos-docs/img/Kairos_800x419.png"><meta data-rh="true" property="og:url" content="https://kairos.io/kairos-docs/blog/trusted-boot"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Unlocking the Mysteries of Trusted Boot: A Deep Dive into Secure System Boot Processes | Kairos"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-04-10T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/mudler"><meta data-rh="true" property="article:tag" content="Kairos"><link data-rh="true" rel="icon" href="/kairos-docs/img/logo.svg"><link data-rh="true" rel="canonical" href="https://kairos.io/kairos-docs/blog/trusted-boot"><link data-rh="true" rel="alternate" href="https://kairos.io/kairos-docs/blog/trusted-boot" hreflang="en"><link data-rh="true" rel="alternate" href="https://kairos.io/kairos-docs/blog/trusted-boot" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://kairos.io/kairos-docs/blog/trusted-boot","mainEntityOfPage":"https://kairos.io/kairos-docs/blog/trusted-boot","url":"https://kairos.io/kairos-docs/blog/trusted-boot","headline":"Unlocking the Mysteries of Trusted Boot: A Deep Dive into Secure System Boot Processes","name":"Unlocking the Mysteries of Trusted Boot: A Deep Dive into Secure System Boot Processes","description":"","datePublished":"2024-04-10T00:00:00.000Z","author":{"@type":"Person","name":"Ettore Di Giacinto","url":"https://github.com/mudler","image":"https://github.com/mudler.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://kairos.io/kairos-docs/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/kairos-docs/blog/rss.xml" title="Kairos RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/kairos-docs/blog/atom.xml" title="Kairos Atom Feed">




<script src="https://buttons.github.io/buttons.js" async defer="defer"></script><link rel="stylesheet" href="/kairos-docs/assets/css/styles.c9791132.css">
<script src="/kairos-docs/assets/js/runtime~main.f112c33f.js" defer="defer"></script>
<script src="/kairos-docs/assets/js/main.a6b903dc.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/kairos-docs/img/logo.svg"><link rel="preload" as="image" href="https://github.com/mudler.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/kairos-docs/"><div class="navbar__logo"><img src="/kairos-docs/img/logo.svg" alt="Kairos Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/kairos-docs/img/logo.svg" alt="Kairos Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Kairos</b></a><a class="navbar__item navbar__link" href="/kairos-docs/docs/getting-started">Getting Started</a><a class="navbar__item navbar__link" href="/kairos-docs/docs/3.6.0/getting-started/">Documentation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/kairos-docs/blog">Blog</a><a href="https://kairos.io/community/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/kairos-docs/docs/3.6.0/getting-started/">3.6.0 (Latest)</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/kairos-docs/docs/next/getting-started/">Next ðŸš§</a></li><li><a class="dropdown__link" href="/kairos-docs/docs/3.6.0/getting-started/">3.6.0 (Latest)</a></li><li><a class="dropdown__link" href="/kairos-docs/docs/3.5.7/getting-started/">3.5.7</a></li></ul></div><div class="navbar__item"><a class="github-button" href="https://github.com/kairos-io/kairos" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star kairos-io/kairos on GitHub">Star</a></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/kairos-docs/blog/commercial-support-by-spectro-cloud">Growing Stronger: Introducing Commercial Support for Kairos</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/kairos-docs/blog/release-v3.5.0">Kairos release v3.5.0</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/kairos-docs/blog/release-v3.4.0">Kairos release v3.4.0</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/kairos-docs/blog/system-extensions">System Extensions, Simplified: Live Customization with Kairos</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/kairos-docs/blog/kairos-meets-k0s">Kairos Meets k0s: A Meta-Distribution for Kubernetes is Born</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">Unlocking the Mysteries of Trusted Boot: A Deep Dive into Secure System Boot Processes</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-04-10T00:00:00.000Z">April 10, 2024</time> Â· <!-- -->16 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/mudler" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/mudler.png" alt="Ettore Di Giacinto"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/mudler" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp" translate="no">Ettore Di Giacinto</span></a></div><div class="authorSocials_rSDt"><a href="https://github.com/mudler" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 256 250" preserveAspectRatio="xMidYMid" style="--dark:#000;--light:#fff" class="authorSocialIcon_XYv3 githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"></path></svg></a><a href="https://x.com/mudler_it" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="X"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="none" viewBox="0 0 1200 1227" style="--dark:#000;--light:#fff" class="authorSocialIcon_XYv3 xSvg_y3PF"><path d="M714.163 519.284 1160.89 0h-105.86L667.137 450.887 357.328 0H0l468.492 681.821L0 1226.37h105.866l409.625-476.152 327.181 476.152H1200L714.137 519.284h.026ZM569.165 687.828l-47.468-67.894-377.686-540.24h162.604l304.797 435.991 47.468 67.894 396.2 566.721H892.476L569.165 687.854v-.026Z"></path></svg></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>In the evolving landscape of cybersecurity, protecting the integrity of computing systems from the moment they power on has become very important. As threats become more sophisticated, understanding and implementing advanced boot security mechanisms like Trusted Boot, Full Disk Encryption (FDE), Secure Boot, and Measured Boot are critical for safeguarding data and ensuring system integrity. This article demystifies these concepts, explores their significance, and examines their implementation in modern computing environments, particularly focusing on the Linux ecosystem and the approaches within the Kairos project.</p>
<blockquote>
<p>We are facing new challenges as 2024 starts. While AI is pushing innovating technologies to the edge, security becomes even more critical for organizations to protect sensitive data.</p>
</blockquote>
<p><img decoding="async" loading="lazy" src="https://github.com/kairos-io/kairos-docs/assets/2420543/868bad37-b00d-4db9-9904-ad16814f9f65" alt="atm" class="img_ev3q"></p>
<blockquote>
<p>Image credits <a href="https://www.reddit.com/r/PBSOD/comments/c8nusw/it_is_now_safe_to_turn_off_your_computer_atm_in/" target="_blank" rel="noopener noreferrer" class="">https://www.reddit.com/r/PBSOD/comments/c8nusw/it_is_now_safe_to_turn_off_your_computer_atm_in/</a></p>
</blockquote>
<p>As industries evolve over time, security measures are increasing to protect edge devices from attackers. New attack vectors and vulnerabilities are exploited every day by cybercriminals, making it crucial for industries to continuously update and enhance their security systems. In the context of edge devices, which are computing elements that process data at the edge of the network, closer to the source of data generation, this need is even more pronounced. These devices, including ATMs, point-of-sale systems, and IoT devices, are often the front line of cybersecurity battles.</p>
<p>One of the primary challenges in securing edge devices is their inherent diversity and distributed nature. Unlike centralized systems, edge devices are spread across various locations, often in unsecured or semi-secured environments, making physical and network security a significant concern. This dispersion also implies a broad attack surface, with each device potentially offering a unique set of vulnerabilities. What we are trying to build here is a new foundation to define how to deploy secure devices which cannot be tampered with, and can keep data secure from malicious actors. We do want to protect the software stack that we run on it .</p>
<p>Our goal is simple but complex to achieve: No unauthorized access to the software, to the data which is generated by the machine, and finally, we donâ€™t want the machine to execute modified code.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="the-essence-of-boot-security-and-encryption">The Essence of Boot Security and Encryption<a href="#the-essence-of-boot-security-and-encryption" class="hash-link" aria-label="Direct link to The Essence of Boot Security and Encryption" title="Direct link to The Essence of Boot Security and Encryption" translate="no">â€‹</a></h2>
<p><img decoding="async" loading="lazy" src="https://github.com/kairos-io/kairos-docs/assets/2420543/ea0a4d89-b037-44a2-a89b-7ad586787201" alt="DALLÂ·E" class="img_ev3q"></p>
<p>Here comes Trusted Boot and SENA to the rescue. Easier to explain with an Alice metaphor.</p>
<blockquote>
<p>You can read more about Trusted Boot in the <a href="https://0pointer.de/blog/brave-new-trusted-boot-world.html" target="_blank" rel="noopener noreferrer" class="">Lennart blog</a> and about SENA in our <a href="https://kairos.io/blog/2023/04/18/kairos-is-now-part-of-the-secure-edge-native-architecture-by-spectro-cloud-and-intel/" target="_blank" rel="noopener noreferrer" class="">blog post</a></p>
</blockquote>
<p>Let&#x27;s imagine Alice has this super cool treasure chest, chock-full of her most prized stuff. Sheâ€™s big on security, but in a high-tech way â€“ kind of like how your computer needs to keep its data safe. To get this done, your computer uses some smart tricks, things like Trusted Boot, Full Disk Encryption (FDE), Secure Boot, and Measured Boot.</p>
<p>To picture Full Disk Encryption, or FDE, think of it as Aliceâ€™s treasure chest having a lock that only opens with a secret code. Itâ€™s so clever that if someone breaks into her house and finds the chest, they still canâ€™t get inside without that special code. FDE is like that for your computer â€“ it scrambles all your data so that only someone with the right password can read it.</p>
<p>Next, there&#x27;s Secure Boot. Imagine if Alice had this smart doorbell. When someone presses it, the doorbell checks if they&#x27;re on the guest list. If they&#x27;re not, no entry. Secure Boot is your computer&#x27;s version of this smart doorbell. It checks every piece of software when your computer starts up and only lets the good, trusted stuff in. It keeps out anything that looks fishy.</p>
<p>And then, we have Measured Boot. Picture this as Alice keeping a super detailed logbook. She writes down everything that goes on in her house â€“ who comes in, what they do, you name it. If anything odd pops up, sheâ€™s on it. Measured Boot does something similar for your computer. It watches over the startup process, takes notes, and makes sure everything&#x27;s running just like it should, no funny business.</p>
<p>Putting all these together, youâ€™ve got Trusted Boot, which is like Alice&#x27;s ultimate home security system â€“ the secret-code lock, the smart doorbell, and the detailed logbook, all working together. Weâ€™re going to unpack how these nifty tools keep your computer as secure as Aliceâ€™s treasure chest, making sure your digital world is safe every time you power up.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="challenges-and-solutions-in-implementing-fde-on-linux">Challenges and Solutions in Implementing FDE on Linux<a href="#challenges-and-solutions-in-implementing-fde-on-linux" class="hash-link" aria-label="Direct link to Challenges and Solutions in Implementing FDE on Linux" title="Direct link to Challenges and Solutions in Implementing FDE on Linux" translate="no">â€‹</a></h2>
<p><img decoding="async" loading="lazy" src="https://github.com/kairos-io/kairos-docs/assets/2420543/aee89c19-a5d1-4b75-8b05-bbeef4e2b47e" alt="DALLÂ·E" class="img_ev3q"></p>
<p>While FDE is a standard feature in various operating systems, its implementation in Linux presents unique challenges. The initial boot stage, including the kernel and initial file system setup, cannot be fully encrypted as they have to be read by the firmware and the kernel respectively, leaving a portion of the system exposed. The initramfs for instance is responsible for unencrypting the portions of the disk. However, through careful measures, this unencrypted segment can be protected against tampering, thus securing the system&#x27;s boot process and the encrypted data it accesses.</p>
<p>The Kairos project adopts &quot;Unified Kernel Images&quot; (UKI) to enhance boot security as defined by the <a href="https://uapi-group.org/" target="_blank" rel="noopener noreferrer" class="">UAPI group</a>. UKI files are single, fat binaries that contain the OS and necessary boot components in a single, verified file. This approach simplifies the boot process, allowing for the entire system to be booted securely and efficiently, but it presents as well interesting challenges due to the Firmware restrictions that might depend on the hardware used(such as booting EFI large files, or handling Secure Boot certificates). By leveraging EFI files that can be signed and verified through Secure Boot and measured as a single entity, UKI files represent a significant advancement in boot security.</p>
<p>Central to the Trusted Boot mechanism is the Trusted Platform Module (TPM), a dedicated hardware (also emulated by firmware) component designed for secure cryptographic operations. TPM chips play a critical role in storing encryption keys and measurements securely, enabling the system to verify boot integrity and encrypt user data effectively.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="from-grub-to-systemd-boot">From Grub to systemd-boot<a href="#from-grub-to-systemd-boot" class="hash-link" aria-label="Direct link to From Grub to systemd-boot" title="Direct link to From Grub to systemd-boot" translate="no">â€‹</a></h2>
<p><img decoding="async" loading="lazy" src="https://github.com/kairos-io/kairos-docs/assets/2420543/df3bce6f-4e88-4edd-83b2-ba2d333d9e6f" alt="DALLÂ·E 2024-01-18 18 22 47 - Create a vintage-style digital artwork that visualizes the concept of modernizing technology infrastructure  The central focus should be a retro-futur" class="img_ev3q"></p>
<p>Trusted Boot is deeply integrated into systemd and is currently being actively developed. Linux offers a variety of init systems and bootloaders, such as GRUB. However, systemd includes tools like systemd-measure and ukify, which, although they work with various bootloaders, are particularly effective with systemd-boot. What sets systemd-boot apart from GRUB and other bootloaders is its focus on hardware compatibility support. As we aim to support modern hardware that must meet specific requirements, we prioritize minimizing the attack surface. Therefore, a narrower scope of support is a better fit for our specific needs and preferred over bootloaders designed for broad hardware compatibility, which often carry legacy code and a large patchset (for instance, you can see the number of patches that SUSE applies on top of standard <a href="https://build.opensuse.org/package/show/Base:System/grub2" target="_blank" rel="noopener noreferrer" class="">GRUB</a> package to add support to specific hardware/improve the functionalities). This presents a strong argument for choosing systemd, especially systemd-boot, over other bootloaders which targets recent hardware and a smaller scope.</p>
<p>Why this makes sense: We&#x27;re now in an era where outdated hardware is not our concern. Modern devices don&#x27;t require old drivers, so we have the opportunity to streamline our systems. This translates to a principle of &#x27;less is more&#x27; in our code and in our stack - less software in our stack means enhanced security. We aim for a leaner runtime to run our software, minimizing potential security vulnerabilities. In addition, it also makes sense to use tools that adhere closely to standard specifications.</p>
<p>Considering the transition to modern hardware, especially with widespread EFI support, systemd-stub or systemd-boot is a strong contender to replace GRUB. GRUB has been a staple in the Linux community for years, evolving from versions 0.x to 2.x, which if you are seasoned like me, you have witnessed almost all of them! However, it&#x27;s worth considering the extensive patches applied by distributions and its expansive codebase. While its extensive support and scripting capabilities were once advantageous, they now detract from its suitability as a lightweight option.</p>
<p>The goal is clear: we aim to minimize complexity in building a secure, efficient stack, reusing as much components well trusted and established by the community. By reducing the number of components, we strive for a more secure and streamlined system.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="booting-in-linux">Booting in Linux<a href="#booting-in-linux" class="hash-link" aria-label="Direct link to Booting in Linux" title="Direct link to Booting in Linux" translate="no">â€‹</a></h2>
<p>When a Linux system starts, it goes through a multi-stage process to load the operating system. This process can be broken down roughly into the following steps:</p>
<ol>
<li class="">Firmware Initialization: The system&#x27;s firmware, which could be BIOS or UEFI, performs initial hardware checks and configurations. It then searches for a bootloader, which is typically located in the boot partition or the Master Boot Record (MBR) of the storage device.</li>
<li class="">Bootloader Execution: The bootloader, such as GRUB, is a software responsible for loading the main part of the operating system. Its primary task is to find the Linux kernel, usually located in the same partition, and load it into memory. The bootloader might present a menu or configuration options to choose different kernels or operating systems if multiple are installed.</li>
<li class="">Kernel Loading and Initialization: The kernel is the core of the Linux operating system. Once loaded, it initializes the system&#x27;s hardware and sets up essential services. During this phase, the kernel decompresses and loads an initrd (initial ramdisk). The initrd is a temporary root file system loaded into memory. It includes essential tools and scripts needed to mount the real root file system. In modern Linux systems, initrd is often replaced by initramfs, which serves a similar purpose.</li>
<li class="">File System Setup and Transition: Inside initrd, scripts are executed to prepare the actual root file system. This includes tasks like decrypting and encrypted partitions if present. After preparations are complete, the system makes a transition, referred to as &quot;pivoting&quot;, to the actual root file system.</li>
<li class="">Root File System and User Data: The root partition, now mounted as the root file system, contains all the user data, system configurations, binaries, drivers, and other necessary components for the operating system to function. This is where the system runs from once the boot process is complete.</li>
</ol>
<p>Throughout these stages, the componentsâ€”firmware, bootloader, kernel, initrd, and the root file systemâ€”work in a sequence to load the operating system successfully.</p>
<p>This chain is the one we in the Linux and tech industry are very much familiar with. Several designs and strategies have been developed to secure this stack over time, for instance Verified kernels and drivers, or Secure Boot to sign the bootloader and be able to trust its authenticity. There are various bootloader implementations as well, tied to more secure HW (like TPM devices).</p>
<p>However, as technologies and security measures evolved, attacks evolved as well. Specific hardware now can be leveraged to increase the security posture of the boot process, and it is time for a change, as the market demands more sophisticated security measures to protect against malicious actors.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="booting-with-a-tpm-equipped-hardware">Booting with a TPM-equipped Hardware<a href="#booting-with-a-tpm-equipped-hardware" class="hash-link" aria-label="Direct link to Booting with a TPM-equipped Hardware" title="Direct link to Booting with a TPM-equipped Hardware" translate="no">â€‹</a></h2>
<p>When a device equipped with TPM, and a sufficiently modern hardware boots, several steps happen sequentially.</p>
<p>Many hardware platforms use a Core Root of Trust for Measurements (CRTM), which is the very first thing that boots, even before the firmware. The CRTM gets a hash of the firmware and sends it to the TPM chip, which measures the running software and is a requirement for trusted boot. The TPM chip then loads the firmware/BIOS.</p>
<p>The TPM takes note of the measurement and stores the hash in a bank of multiple platform configuration registers (PCRs). In order to store measurements, the TPM chip extends the banks from the previous values, as these changes to the stack are easy to recognize during the boot.</p>
<p><img decoding="async" loading="lazy" src="https://github.com/kairos-io/kairos-docs/assets/2420543/5a0244c3-ff58-4ea0-83b3-b391ccac0b91" alt="CRTM trusted boot" class="img_ev3q"></p>
<p>Next, the BIOS or firmware measures the subsequent stage (bootloader or UKI) and sends it to the TPM, then loads the UKI and continues booting.</p>
<p>Once the TPM is asked to release an encryption key to unseal the full disk encryption, it will check if the measurements it has are valid. If a bootloader is present, it will have already measured the UKI files, and measurement also happens when initrd starts and when the running system is ready to check any manipulations (e.g., kernel boot command line). The process is also bound to the secure boot signatures, so any manipulation of the UKI files would be allowed only by the key holders.</p>
<p>If a malicious attacker tries to load custom software or modify an image in any way, they must extend the PCR value and align it with the value it would have had following an expected boot. The cryptographic robustness of the hash algorithm makes achieving this computationally expensive, thereby helping to support security.</p>
<p>If the firmware or bootloader have been tampered with, the hash values stored in the PCR wonâ€™t match expected measurements, and the system will flag an alert and prevent boot from happening â€” intentionally bricking the host device as a failsafe (the host is still recoverable by re-installing everything from scratch).</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="kairos-and-trusted-boot">Kairos and Trusted Boot<a href="#kairos-and-trusted-boot" class="hash-link" aria-label="Direct link to Kairos and Trusted Boot" title="Direct link to Kairos and Trusted Boot" translate="no">â€‹</a></h2>
<p><img decoding="async" loading="lazy" src="https://github.com/kairos-io/kairos-docs/assets/2420543/df635d48-e9ff-4759-98d0-3cdaa87ee8b5" alt="standardlinux" class="img_ev3q"></p>
<p>To gain a deeper understanding of the mechanics behind EFI files and the boot process, let&#x27;s delve into the way typical Linux distributions manage booting with Full Disk Encryption (FDE):</p>
<ul>
<li class="">Initially, the firmware retrieves the bootloader from the boot partition (or Master Boot Record - MBR) and transitions control to a kernel.</li>
<li class="">This kernel then unpacks an initrd, which houses essential tools needed for initializing the file system (FS) and transitioning to the operational system environment.</li>
</ul>
<p>In this setup, each component is distinct: the Kernel and Initrd are separate files, whereas the root partition is a unified file system encompassing all user data (such as installed binaries, password files, sensitive information, drivers, etc.). The primary function of the initrd in this scenario is to decrypt partitions and set up mount points as it transitions control to a different partition.</p>
<p><img decoding="async" loading="lazy" src="https://github.com/kairos-io/kairos-docs/assets/2420543/b8e5d6ab-f160-43f2-adb8-395f445dbc12" alt="kairosboot" class="img_ev3q"></p>
<p>Contrastingly, the Kairos architecture utilizes a singular image file that amalgamates the rootfs, kernel, and initrd. Here, the initrd is responsible for establishing the FS and activating the rootfs.</p>
<p>The bootloader plays a pivotal role in this architecture by accessing image files stored within the state partition.</p>
<p>While the state partition remains unencrypted, the system&#x27;s operational projection is derived from the encrypted user-data partition. Directories such as <code>/etc</code> and <code>/opt</code> (which can be fully customized) are overlaid, safeguarding sensitive information from being exposed within the state partition. Nevertheless, this design, along with the previously mentioned setup, is vulnerable to &quot;Evil Maid Attacks.&quot; These attacks involve altering the system by booting from a LiveCD and modifying the booted images.</p>
<p><img decoding="async" loading="lazy" src="https://github.com/kairos-io/kairos-docs/assets/2420543/19b61dd1-b33f-4cfe-9d0a-b60198b0cfd5" alt="boot_1" class="img_ev3q"></p>
<p>In the context of the UKI (Unified Kernel Image) architecture, which closely resembles the Kairos model, the primary distinction lies in the storage of a singular EFI image file within the boot partition. This arrangement facilitates the signing and verification of EFI files to ensure they haven&#x27;t been tampered with, leveraging SecureBoot in tandem with Measured Boot. These mechanisms verify that the image is certified by a trusted authority and remains unmodified.</p>
<p>During the boot process, cryptographic assessments are made using the Trusted Platform Module (TPM) to confirm the system&#x27;s integrity. Drive decryption during boot is contingent upon consistent signing by the same authority and accurate boot measurement matching. System upgrades involve updating the boot measurement to enable access to the user data partitions.</p>
<p><img decoding="async" loading="lazy" src="https://github.com/kairos-io/kairos-docs/assets/2420543/49ad3793-b53e-40e9-96da-58cec5d4df4c" alt="bootingkeys" class="img_ev3q"></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="security-consideration">Security consideration<a href="#security-consideration" class="hash-link" aria-label="Direct link to Security consideration" title="Direct link to Security consideration" translate="no">â€‹</a></h2>
<p>The existing framework guarantees that the initial phase (UKI file) remains immutable, with only this phase capable of decrypting the drive&#x27;s encrypted data. Indeed there is no pivoting into another system like in the traditional Linux boot process. This design choice ensures that the system remains a single component, with the UKI file acting as the sole point of entry for the system.</p>
<p>Shifting to a different image would have introduced potential security vulnerabilities and constraints:</p>
<ul>
<li class="">The current Systemd tools lack the capability to assess another rootfs/file.</li>
<li class="">There is an absence of mechanisms to incorporate PCR with hash checksums of bespoke files in the expanded PCR banks within systemd.</li>
<li class="">The inability to evaluate a secondary phase means any alterations in this stage could remain undetected during operation.</li>
</ul>
<p>Also, implementing measurements for a second phase would significantly complicate the update process, as each version (A/B, Recovery) would require corresponding updates and measurements for every file involved in the transition.</p>
<p>An alternative approach involves maintaining a singular initial phase, which would entail measuring all subsequent stages. However, this concept remains a topic of ongoing debate without any concrete solutions thus far.</p>
<p>A concrete example: should a hacker remotely access the system without measures in place for the transitioned stage, they could alter the entire rootfs during operation without detection. In contrast, by leaving the first stage unaltered in the current method, modifications to the rootfs are prevented.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="learn-more">Learn More<a href="#learn-more" class="hash-link" aria-label="Direct link to Learn More" title="Direct link to Learn More" translate="no">â€‹</a></h2>
<p>Trusted boot is one of many recommended security techniques â€” but itâ€™s absolutely critical to ensuring you can trust the integrity of your device, particularly when itâ€™s deployed in the field.</p>
<p>We&#x27;ve only just scratched the surface of trusted boot as a concept, how it works and the architectural details of the Kairos implementation that contribute to the overall security posture. If youâ€™d like to learn more:</p>
<ul>
<li class=""><a href="https://www.youtube.com/watch?v=6ftX8o_I8P8" target="_blank" rel="noopener noreferrer" class="">Check out our CNCF presentation, available on demand.</a></li>
<li class="">Learn more secure edge architectures including trusted boot, by downloading <a href="https://kairos.io/blog/2023/04/18/kairos-is-now-part-of-the-secure-edge-native-architecture-by-spectro-cloud-and-intel/" target="_blank" rel="noopener noreferrer" class="">the SENA white paper</a>.</li>
<li class="">Check out Kairosâ€™ <a href="https://kairos.io/docs/architecture/trustedboot/" target="_blank" rel="noopener noreferrer" class="">trusted boot architectural documentation</a> and <a href="https://kairos.io/docs/installation/trustedboot/" target="_blank" rel="noopener noreferrer" class="">try it out for yourself</a>.</li>
</ul></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" title="Posts about Kairos, an open-source, cloud-native, and immutable Linux distribution" class="tag_zVej tagRegular_sFm0" href="/kairos-docs/blog/tags/kairos">Kairos</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/kairos-io/kairos/tree/main/packages/create-kairos/templates/shared/blog/2024-04-10-trusted-boot.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/kairos-docs/blog/release-v3.1"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Kairos release v3.1</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/kairos-docs/blog/xz-backdoor"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">xz Utils Backdoor</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-essence-of-boot-security-and-encryption" class="table-of-contents__link toc-highlight">The Essence of Boot Security and Encryption</a></li><li><a href="#challenges-and-solutions-in-implementing-fde-on-linux" class="table-of-contents__link toc-highlight">Challenges and Solutions in Implementing FDE on Linux</a></li><li><a href="#from-grub-to-systemd-boot" class="table-of-contents__link toc-highlight">From Grub to systemd-boot</a></li><li><a href="#booting-in-linux" class="table-of-contents__link toc-highlight">Booting in Linux</a></li><li><a href="#booting-with-a-tpm-equipped-hardware" class="table-of-contents__link toc-highlight">Booting with a TPM-equipped Hardware</a></li><li><a href="#kairos-and-trusted-boot" class="table-of-contents__link toc-highlight">Kairos and Trusted Boot</a></li><li><a href="#security-consideration" class="table-of-contents__link toc-highlight">Security consideration</a></li><li><a href="#learn-more" class="table-of-contents__link toc-highlight">Learn More</a></li></ul></div></div></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/kairos-docs/docs/getting-started">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/kairos-docs/docs/installation">Installation</a></li><li class="footer__item"><a class="footer__link-item" href="/kairos-docs/docs/architecture">Architecture</a></li><li class="footer__item"><a class="footer__link-item" href="/kairos-docs/docs/examples">Examples</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://slack.cncf.io/#kairos" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/kairos-io/kairos/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/kairos-oss/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/Kairos_OSS" target="_blank" rel="noopener noreferrer" class="footer__link-item">X (Twitter)<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/kairos-docs/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/kairos-io/kairos" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.spectrocloud.com/solutions/kairos-support" target="_blank" rel="noopener noreferrer" class="footer__link-item">Commercial Support<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2025 Kairos authors</div></div></div></footer></div>
</body>
</html>