<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Architecture/trustedboot" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Trusted Boot Architecture | Kairos</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kairos.io/kairos-docs/img/Kairos_800x419.png"><meta data-rh="true" name="twitter:image" content="https://kairos.io/kairos-docs/img/Kairos_800x419.png"><meta data-rh="true" property="og:url" content="https://kairos.io/kairos-docs/docs/next/Architecture/trustedboot"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Trusted Boot Architecture | Kairos"><meta data-rh="true" name="description" content="Trusted boot is a combination of technologies that allows us to enhance the security posture of a running system. It is composed by FDE, Secure Boot and Measured Boot."><meta data-rh="true" property="og:description" content="Trusted boot is a combination of technologies that allows us to enhance the security posture of a running system. It is composed by FDE, Secure Boot and Measured Boot."><link data-rh="true" rel="icon" href="/kairos-docs/img/logo.svg"><link data-rh="true" rel="canonical" href="https://kairos.io/kairos-docs/docs/next/Architecture/trustedboot"><link data-rh="true" rel="alternate" href="https://kairos.io/kairos-docs/docs/next/Architecture/trustedboot" hreflang="en"><link data-rh="true" rel="alternate" href="https://kairos.io/kairos-docs/docs/next/Architecture/trustedboot" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Architecture","item":"https://kairos.io/kairos-docs/docs/next/category/architecture"},{"@type":"ListItem","position":2,"name":"Trusted Boot","item":"https://kairos.io/kairos-docs/docs/next/Architecture/trustedboot"}]}</script><link rel="alternate" type="application/rss+xml" href="/kairos-docs/blog/rss.xml" title="Kairos RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/kairos-docs/blog/atom.xml" title="Kairos Atom Feed">




<script src="https://buttons.github.io/buttons.js" async defer="defer"></script><link rel="stylesheet" href="/kairos-docs/assets/css/styles.c9791132.css">
<script src="/kairos-docs/assets/js/runtime~main.f112c33f.js" defer="defer"></script>
<script src="/kairos-docs/assets/js/main.a6b903dc.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/kairos-docs/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/kairos-docs/"><div class="navbar__logo"><img src="/kairos-docs/img/logo.svg" alt="Kairos Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/kairos-docs/img/logo.svg" alt="Kairos Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Kairos</b></a><a class="navbar__item navbar__link" href="/kairos-docs/docs/getting-started">Getting Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/kairos-docs/docs/next/getting-started/">Documentation</a><a class="navbar__item navbar__link" href="/kairos-docs/blog">Blog</a><a href="https://kairos.io/community/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/kairos-docs/docs/next/Architecture/trustedboot">Next ðŸš§</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/kairos-docs/docs/next/Architecture/trustedboot">Next ðŸš§</a></li><li><a class="dropdown__link" href="/kairos-docs/docs/3.6.0/Architecture/trustedboot">3.6.0 (Latest)</a></li><li><a class="dropdown__link" href="/kairos-docs/docs/3.5.7/Architecture/trustedboot">3.5.7</a></li></ul></div><div class="navbar__item"><a class="github-button" href="https://github.com/kairos-io/kairos" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star kairos-io/kairos on GitHub">Star</a></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/kairos-docs/docs/next/getting-started/"><span title="Getting Started" class="categoryLinkLabel_W154">Getting Started</span></a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/kairos-docs/docs/next/category/installation"><span title="Installation" class="categoryLinkLabel_W154">Installation</span></a><button aria-label="Expand sidebar category &#x27;Installation&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/kairos-docs/docs/next/category/architecture"><span title="Architecture" class="categoryLinkLabel_W154">Architecture</span></a><button aria-label="Collapse sidebar category &#x27;Architecture&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/next/Architecture/immutable"><span title="Immutable" class="linkLabel_WmDU">Immutable</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/next/Architecture/container"><span title="Container" class="linkLabel_WmDU">Container</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/next/Architecture/cloud-init"><span title="Cloud init based" class="linkLabel_WmDU">Cloud init based</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/next/Architecture/secureboot"><span title="SecureBoot support" class="linkLabel_WmDU">SecureBoot support</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/next/Architecture/meta"><span title="Meta-Distribution" class="linkLabel_WmDU">Meta-Distribution</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/next/Architecture/network"><span title="P2P Network" class="linkLabel_WmDU">P2P Network</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/kairos-docs/docs/next/Architecture/trustedboot"><span title="Trusted Boot" class="linkLabel_WmDU">Trusted Boot</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/kairos-docs/docs/next/category/advanced"><span title="Advanced" class="categoryLinkLabel_W154">Advanced</span></a><button aria-label="Expand sidebar category &#x27;Advanced&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/kairos-docs/docs/next/Upgrade/manual"><span title="Upgrade" class="categoryLinkLabel_W154">Upgrade</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/kairos-docs/docs/next/category/reference"><span title="Reference" class="categoryLinkLabel_W154">Reference</span></a><button aria-label="Expand sidebar category &#x27;Reference&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/kairos-docs/docs/next/category/development"><span title="Development" class="categoryLinkLabel_W154">Development</span></a><button aria-label="Expand sidebar category &#x27;Development&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/kairos-docs/docs/next/Examples/boot_assessment_trusted_boot"><span title="Examples" class="categoryLinkLabel_W154">Examples</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for <!-- -->Kairos<!-- --> <b>Next ðŸš§</b> version.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/kairos-docs/docs/3.6.0/Architecture/trustedboot">latest version</a></b> (<!-- -->3.6.0 (Latest)<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/kairos-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/kairos-docs/docs/next/category/architecture"><span>Architecture</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Trusted Boot</span></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: Next ðŸš§</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Trusted Boot Architecture</h1></header><p>Trusted boot is a combination of technologies that allows us to enhance the security posture of a running system. It is composed by FDE, Secure Boot and Measured Boot.
Trusted boot is an architectural requirement of <a href="https://www.spectrocloud.com/product/sena" target="_blank" rel="noopener noreferrer" class="">SENA (Secure Edge Native Architecture)</a> and is a key component of Kairos.</p>
<blockquote>
<p>You can read more about Trusted Boot in <a href="https://0pointer.de/blog/brave-new-trusted-boot-world.html" target="_blank" rel="noopener noreferrer" class="">https://0pointer.de/blog/brave-new-trusted-boot-world.html</a> and about SENA here: <a href="https://kairos.io/blog/2023/04/18/kairos-is-now-part-of-the-secure-edge-native-architecture-by-spectro-cloud-and-intel/" target="_blank" rel="noopener noreferrer" class="">https://kairos.io/blog/2023/04/18/kairos-is-now-part-of-the-secure-edge-native-architecture-by-spectro-cloud-and-intel/</a></p>
</blockquote>
<p>By combining Secure Boot, Measured Boot and FDE we can guarantee that a system was not tampered with, and the user-data is protected by cold attacks, we refer to this combination of technologies stacked together with &quot;Trusted Boot&quot; or &quot;Trusted Boot Experience&quot;.</p>
<p><em>FDE</em> stands for Full Disk Encryption. It is a security measure that encrypts the entire contents of a disk drive, including the operating system, system files, and user data. The purpose of FDE is to protect data stored on the disk from unauthorized access in the event of theft or loss of the device.</p>
<p><em>Secure Boot</em> is a security feature in modern computer systems that ensures only properly signed and authenticated OSes are allowed to run during the boot process. It helps prevent the loading of malicious or unauthorized code at the early stages of the system startup, thus helping in protecting the integrity of the boot process.</p>
<p><em>Measured Boot</em>, on the other hand, is a security mechanism that goes beyond Secure Boot. It involves creating a record, or &quot;measurements,&quot; of each step in the boot process and storing these measurements in a specific hardware dedicated to cryptographically secure operations ( trusted platform module, or TPM) or a similar secure storage. This allows the system to verify the integrity of each component of the boot process and detect any unauthorized changes. Measured Boot provides a more comprehensive and continuous security check throughout the boot sequence.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="uki-and-usi">UKI and USI<a href="#uki-and-usi" class="hash-link" aria-label="Direct link to UKI and USI" title="Direct link to UKI and USI" translate="no">â€‹</a></h3>
<p><a href="https://uapi-group.org/specifications/specs/unified_kernel_image/" target="_blank" rel="noopener noreferrer" class="">UKI</a> is a specific file format tailored to achieve a tamper-proof system and encryption of user-data bound to the silicon by relying on HW capabilities.</p>
<blockquote>
<p>UKI stands for &quot;Unified Kernel Images&quot;. UKI files are a single, fat binary that encompasses the OS and the needed bits in order to boot the full system with a single, verified file. You can read technical details here: <a href="https://0pointer.de/blog/brave-new-trusted-boot-world.html" target="_blank" rel="noopener noreferrer" class="">Brave New Trusted Boot World</a>.</p>
</blockquote>
<p>Trusted Boot in Kairos works by generating UKI images from container images. The UKI file is a single, fat binary that encompasses the OS and the needed bits in order to boot the full system with a single, verified file. This file can be used for upgrades and used as usual in the lifecycle of the Kairos node.</p>
<p>The UKI file is signed with the Secure Boot keys, and the user-data is encrypted with the PCR policies. The UKI file is then loaded by the firmware and booted directly, without any second stage or system pivoting. This is why the UKI file can grow large, and why it requires a specific firmware that supports booting large EFI files.</p>
<p>Due to the design choice to not boot into a second stage, this is being refered nowadays as <strong>USI</strong> (Unified System Image) instead of UKI, or more simply &quot;Bootstrap Image&quot;. The benefits of using Unified system images in opposite of UKIs are that the system can be upgraded without the need of a second stage, and that the entire system is verified and signed.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="building-process">Building process<a href="#building-process" class="hash-link" aria-label="Direct link to Building process" title="Direct link to Building process" translate="no">â€‹</a></h3>
<p>Trusted Boot requires you to create a specific installable ISO file that includes the UKI files and a container image used for upgrades. Each time you upgrade a system, you must regenerate these assets using the same keys and then use the newly generated container image for the upgrade process.</p>
<p>The UKI files are generated from container images as usual.</p>
<p><img decoding="async" loading="lazy" src="https://github.com/kairos-io/kairos-docs/assets/2420543/2f49d592-9ae3-43ee-b22b-0313be455bf7" alt="Trusted boot" class="img_ev3q"></p>
<p>The process to generate the installable medium is described in the <a class="" href="/kairos-docs/docs/next/Architecture/trustedboot">Trustedboot installation documentation</a>. Internally we rely on the <em>osbuilder</em> tool to generate all the installation artifacts from a single container image.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="booting-process">Booting process<a href="#booting-process" class="hash-link" aria-label="Direct link to Booting process" title="Direct link to Booting process" translate="no">â€‹</a></h3>
<p><img decoding="async" loading="lazy" src="https://github.com/kairos-io/kairos-docs/assets/2420543/9c406796-b622-4571-abd5-b8d8fed44591" alt="boot_1" class="img_ev3q"></p>
<p>The booting process of an installed system with Trusted Boot is different from a standard Kairos installation, and can be split down in 4 steps:</p>
<ol>
<li class="">The Firmware loads the <code>systemd-boot</code> bootloader from the EFI partition</li>
<li class=""><code>systemd-boot</code> loads the UKI file from the EFI partition (that can be either the Active system, the passive or recovery system)</li>
<li class="">The EFI system starts. The kernel and the initrd are loaded from the UKI file, and the kernel is booted with the command line specified in the UKI file.</li>
<li class="">The initrd will decrypt the user-data and mount the portions of it in the root filesystem. This includes for instance any changes to <code>/etc</code> (like adding new users and passwords), <code>/usr/local</code>, and all the mount bindpoints specified in the configuration file (see <a class="" href="/kairos-docs/docs/next/Architecture/customizing#bind-mounts">Bind mount documentation</a> ). There is no second stage loaded and no system pivoting, the system is booted directly from the UKI file.</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="booting-system">Booting system<a href="#booting-system" class="hash-link" aria-label="Direct link to Booting system" title="Direct link to Booting system" translate="no">â€‹</a></h3>
<p><img decoding="async" loading="lazy" src="https://github.com/kairos-io/kairos-docs/assets/2420543/757870d3-3b40-46ea-9c86-13c4a545f167" alt="Trusted boot" class="img_ev3q"></p>
<p>There is no difference with a layout of a standard Kairos system (as explained in the <a class="" href="/kairos-docs/docs/next/Architecture/immutable">Immutable OS</a> page), however in this setup now the partitions containing data are always encrypted:</p>
<ul>
<li class=""><a href="https://github.com/kairos-io/packages/blob/528682cddf7191fb52580e7c41a33e73c1ee0001/packages/static/kairos-overlay-files/files/system/oem/00_rootfs_uki.yaml#L18" target="_blank" rel="noopener noreferrer" class="">List of persistent data path overlayed and encrypted</a> (see also <a class="" href="/kairos-docs/docs/next/Architecture/customizing#bind-mounts">the bind mount documentation</a> to customize it with your own paths).</li>
<li class=""><code>/oem</code> encrypted</li>
<li class=""><code>/usr/local</code> encrypted</li>
<li class=""><code>/etc</code> ephemeral</li>
<li class=""><code>/usr</code> read only</li>
<li class=""><code>/</code> immutable</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="user-data-encryption-and-key-generation">User data encryption and key generation<a href="#user-data-encryption-and-key-generation" class="hash-link" aria-label="Direct link to User data encryption and key generation" title="Direct link to User data encryption and key generation" translate="no">â€‹</a></h3>
<p>It is required in order to generate USI images to have a set of keys and certificates. In order to understand why those keys are required, we need to understand how the user-data is encrypted and how the system is booted.</p>
<p><img decoding="async" loading="lazy" src="https://github.com/kairos-io/kairos-docs/assets/2420543/725745a0-0ea6-4330-bea3-e6483f53cc3f" alt="bootingkeys" class="img_ev3q"></p>
<p>The keys are used to sign the UKI file, and to generate a PCR policy keypair required later on by the system in order to decrypt the encrypted partitions. The keys and certificates are generated with the <code>auroraboot</code> tool, that is available in the <code>auroraboot</code> container image.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="expanding-the-system-with-system-extensions">Expanding the system with system extensions<a href="#expanding-the-system-with-system-extensions" class="hash-link" aria-label="Direct link to Expanding the system with system extensions" title="Direct link to Expanding the system with system extensions" translate="no">â€‹</a></h3>
<p>Check the relevant documentation on how to <a class="" href="/kairos-docs/docs/next/Architecture/sys-extensions">extend the system with system extensions</a> and how to <a class="" href="/kairos-docs/docs/next/Architecture/adding_opt_to_system_extensions">use /opt with system extensions</a>.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="trusted-boot---boot-assessment">Trusted Boot - Boot Assessment<a href="#trusted-boot---boot-assessment" class="hash-link" aria-label="Direct link to Trusted Boot - Boot Assessment" title="Direct link to Trusted Boot - Boot Assessment" translate="no">â€‹</a></h3>
<p>See the <a class="" href="/kairos-docs/docs/next/Architecture/boot_assessment_trusted_boot">Trusted Boot - Boot Assessment</a> documentation for more information on how to enable automatic boot assessment with Trusted Boot and how to make your own services participate in the boot assessment process.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="considerations">Considerations<a href="#considerations" class="hash-link" aria-label="Direct link to Considerations" title="Direct link to Considerations" translate="no">â€‹</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="booting-command-lines">Booting command lines<a href="#booting-command-lines" class="hash-link" aria-label="Direct link to Booting command lines" title="Direct link to Booting command lines" translate="no">â€‹</a></h4>
<p>UKI file&#x27;s signatures are including also the kernel command line, so any change to the kernel command line will require a new UKI file to be generated and the installer image to be rebuilt. This implies that you cannot change the booting options once the system is installed (and the system won&#x27;t be able to access the encrypted data)</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="references">References<a href="#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References" translate="no">â€‹</a></h3>
<ul>
<li class=""><a href="https://uefi.org/sites/default/files/resources/UEFI_Spec_2_8_final.pdf" target="_blank" rel="noopener noreferrer" class="">UEFI specification</a></li>
<li class=""><a href="https://documentation.suse.com/sled/15-SP5/html/SLED-all/cha-uefi.html" target="_blank" rel="noopener noreferrer" class="">UEFI (SLE documentation)</a></li>
<li class=""><a href="https://cdrdv2-public.intel.com/671120/a-tour-beyond-bios-implementing-uefi-authenticated-variables-in-smm-with-edkii.pdf" target="_blank" rel="noopener noreferrer" class="">https://cdrdv2-public.intel.com/671120/a-tour-beyond-bios-implementing-uefi-authenticated-variables-in-smm-with-edkii.pdf</a></li>
<li class=""><a href="https://www.vut.cz/www_base/zav_prace_soubor_verejne.php?file_id=132208" target="_blank" rel="noopener noreferrer" class="">SUPPORT OF SECURE BOOT IN SYSTEMD-BOOT PROJECT</a></li>
<li class=""><a href="https://uapi-group.org/specifications/specs/unified_kernel_image/#file-format" target="_blank" rel="noopener noreferrer" class="">UKI file format</a></li>
<li class=""><a href="https://wiki.archlinux.org/title/Unified_Extensible_Firmware_Interface/Secure_Boot" target="_blank" rel="noopener noreferrer" class="">Secure Boot</a></li>
</ul>
<p>For more information about installing Kairos with Trusted Boot, see the <a class="" href="/kairos-docs/docs/next/Architecture/trustedboot">Trusted Boot Installation Guide</a>.</p>
<p>For more information about customizing Kairos images, see the <a class="" href="/kairos-docs/docs/next/Architecture/customizing">Customizing Images</a> guide.</p>
<p>For more information about the immutable nature of Kairos, see the <a class="" href="/kairos-docs/docs/next/Architecture/immutable">Immutable Architecture</a> guide.</p>
<p>For more information about system extensions, see the <a class="" href="/kairos-docs/docs/next/Architecture/sys-extensions">System Extensions</a> guide.</p>
<p>For more informations about revoking certificates, see <a class="" href="/kairos-docs/docs/next/advanced/revoking-secureboot-access">Revoking secure boot access</a></p>
<p>For a complete example of boot assessment with Trusted Boot, see the <a class="" href="/kairos-docs/docs/next/Architecture/boot_assessment_trusted_boot">Boot Assessment with Trusted Boot</a> guide.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/kairos-io/kairos-docs/tree/main/docs/Architecture/trustedboot.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-12-06T17:56:03.000Z" itemprop="dateModified">Dec 6, 2025</time></b> by <b>Jasper De Keukelaere (imec)</b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/kairos-docs/docs/next/Architecture/network"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">P2P Network</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/kairos-docs/docs/next/category/advanced"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Advanced</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#uki-and-usi" class="table-of-contents__link toc-highlight">UKI and USI</a></li><li><a href="#building-process" class="table-of-contents__link toc-highlight">Building process</a></li><li><a href="#booting-process" class="table-of-contents__link toc-highlight">Booting process</a></li><li><a href="#booting-system" class="table-of-contents__link toc-highlight">Booting system</a></li><li><a href="#user-data-encryption-and-key-generation" class="table-of-contents__link toc-highlight">User data encryption and key generation</a></li><li><a href="#expanding-the-system-with-system-extensions" class="table-of-contents__link toc-highlight">Expanding the system with system extensions</a></li><li><a href="#trusted-boot---boot-assessment" class="table-of-contents__link toc-highlight">Trusted Boot - Boot Assessment</a></li><li><a href="#considerations" class="table-of-contents__link toc-highlight">Considerations</a></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/kairos-docs/docs/getting-started">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/kairos-docs/docs/installation">Installation</a></li><li class="footer__item"><a class="footer__link-item" href="/kairos-docs/docs/architecture">Architecture</a></li><li class="footer__item"><a class="footer__link-item" href="/kairos-docs/docs/examples">Examples</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://slack.cncf.io/#kairos" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/kairos-io/kairos/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/kairos-oss/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/Kairos_OSS" target="_blank" rel="noopener noreferrer" class="footer__link-item">X (Twitter)<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/kairos-docs/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/kairos-io/kairos" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.spectrocloud.com/solutions/kairos-support" target="_blank" rel="noopener noreferrer" class="footer__link-item">Commercial Support<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2025 Kairos authors</div></div></div></footer></div>
</body>
</html>