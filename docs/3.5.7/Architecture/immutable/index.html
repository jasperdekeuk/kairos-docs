<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-3.5.7 docs-doc-page docs-doc-id-Architecture/immutable" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Immutable | Kairos</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kairos.io/kairos-docs/img/Kairos_800x419.png"><meta data-rh="true" name="twitter:image" content="https://kairos.io/kairos-docs/img/Kairos_800x419.png"><meta data-rh="true" property="og:url" content="https://kairos.io/kairos-docs/docs/3.5.7/Architecture/immutable"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="3.5.7"><meta data-rh="true" name="docusaurus_tag" content="docs-default-3.5.7"><meta data-rh="true" name="docsearch:version" content="3.5.7"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-3.5.7"><meta data-rh="true" property="og:title" content="Immutable | Kairos"><meta data-rh="true" name="description" content="Learn about Kairos&#x27; immutable architecture design, where the system boots in a restricted, permissionless mode with read-only paths. Discover how this approach enhances security, simplifies maintenance, and enables predictable upgrades across your infrastructure."><meta data-rh="true" property="og:description" content="Learn about Kairos&#x27; immutable architecture design, where the system boots in a restricted, permissionless mode with read-only paths. Discover how this approach enhances security, simplifies maintenance, and enables predictable upgrades across your infrastructure."><link data-rh="true" rel="icon" href="/kairos-docs/img/logo.svg"><link data-rh="true" rel="canonical" href="https://kairos.io/kairos-docs/docs/3.5.7/Architecture/immutable"><link data-rh="true" rel="alternate" href="https://kairos.io/kairos-docs/docs/3.5.7/Architecture/immutable" hreflang="en"><link data-rh="true" rel="alternate" href="https://kairos.io/kairos-docs/docs/3.5.7/Architecture/immutable" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Architecture","item":"https://kairos.io/kairos-docs/docs/3.5.7/category/architecture"},{"@type":"ListItem","position":2,"name":"Immutable","item":"https://kairos.io/kairos-docs/docs/3.5.7/Architecture/immutable"}]}</script><link rel="alternate" type="application/rss+xml" href="/kairos-docs/blog/rss.xml" title="Kairos RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/kairos-docs/blog/atom.xml" title="Kairos Atom Feed">




<script src="https://buttons.github.io/buttons.js" async defer="defer"></script><link rel="stylesheet" href="/kairos-docs/assets/css/styles.c9791132.css">
<script src="/kairos-docs/assets/js/runtime~main.9f032563.js" defer="defer"></script>
<script src="/kairos-docs/assets/js/main.17196749.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/kairos-docs/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/kairos-docs/"><div class="navbar__logo"><img src="/kairos-docs/img/logo.svg" alt="Kairos Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/kairos-docs/img/logo.svg" alt="Kairos Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Kairos</b></a><a class="navbar__item navbar__link" href="/kairos-docs/docs/getting-started">Getting Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/kairos-docs/docs/3.5.7/getting-started/">Documentation</a><a class="navbar__item navbar__link" href="/kairos-docs/blog">Blog</a><a href="https://kairos.io/community/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/kairos-docs/docs/3.5.7/Architecture/immutable">3.5.7</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/kairos-docs/docs/next/Architecture/immutable">Next ðŸš§</a></li><li><a class="dropdown__link" href="/kairos-docs/docs/3.6.0/Architecture/immutable">3.6.0 (Latest)</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/kairos-docs/docs/3.5.7/Architecture/immutable">3.5.7</a></li></ul></div><div class="navbar__item"><a class="github-button" href="https://github.com/kairos-io/kairos" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star kairos-io/kairos on GitHub">Star</a></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/kairos-docs/docs/3.5.7/getting-started/"><span title="Getting Started" class="categoryLinkLabel_W154">Getting Started</span></a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/kairos-docs/docs/3.5.7/category/installation"><span title="Installation" class="categoryLinkLabel_W154">Installation</span></a><button aria-label="Expand sidebar category &#x27;Installation&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/kairos-docs/docs/3.5.7/category/architecture"><span title="Architecture" class="categoryLinkLabel_W154">Architecture</span></a><button aria-label="Collapse sidebar category &#x27;Architecture&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/kairos-docs/docs/3.5.7/Architecture/immutable"><span title="Immutable" class="linkLabel_WmDU">Immutable</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Architecture/container"><span title="Container" class="linkLabel_WmDU">Container</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Architecture/cloud-init"><span title="Cloud init based" class="linkLabel_WmDU">Cloud init based</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Architecture/secureboot"><span title="SecureBoot support" class="linkLabel_WmDU">SecureBoot support</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Architecture/meta"><span title="Meta-Distribution" class="linkLabel_WmDU">Meta-Distribution</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Architecture/network"><span title="P2P Network" class="linkLabel_WmDU">P2P Network</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Architecture/trustedboot"><span title="Trusted Boot" class="linkLabel_WmDU">Trusted Boot</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/kairos-docs/docs/3.5.7/category/examples"><span title="Examples" class="categoryLinkLabel_W154">Examples</span></a><button aria-label="Expand sidebar category &#x27;Examples&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/kairos-docs/docs/3.5.7/category/advanced"><span title="Advanced" class="categoryLinkLabel_W154">Advanced</span></a><button aria-label="Expand sidebar category &#x27;Advanced&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/kairos-docs/docs/3.5.7/category/upgrade"><span title="Upgrade" class="categoryLinkLabel_W154">Upgrade</span></a><button aria-label="Expand sidebar category &#x27;Upgrade&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/kairos-docs/docs/3.5.7/category/reference"><span title="Reference" class="categoryLinkLabel_W154">Reference</span></a><button aria-label="Expand sidebar category &#x27;Reference&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/kairos-docs/docs/3.5.7/category/development"><span title="Development" class="categoryLinkLabel_W154">Development</span></a><button aria-label="Expand sidebar category &#x27;Development&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Kairos<!-- --> <b>3.5.7</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/kairos-docs/docs/3.6.0/Architecture/immutable">latest version</a></b> (<!-- -->3.6.0 (Latest)<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/kairos-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/kairos-docs/docs/3.5.7/category/architecture"><span>Architecture</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Immutable</span></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 3.5.7</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Immutable</h1></header><p>Kairos adopts an immutable layout and derivatives created with its toolkit, inherit the same immutability attributes.</p>
<p>An immutable OS is a carefully engineered system which boots in a restricted, permissionless mode, where certain paths of the system are not writable. For instance, after installation it&#x27;s not possible to add additional packages to the system, and any configuration change is discarded after reboot.</p>
<p>A running Linux-based OS system will have the following paths:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/usr/local - persistent ( partition label COS_PERSISTENT)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/oem - persistent ( partition label COS_OEM)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var - ephemeral</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/etc - ephemeral</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/srv - ephemeral</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/ immutable</span><br></span></code></pre></div></div>
<p><code>/usr/local</code> will contain all the persistent data which will be carried over in-between upgrades, unlike the changes made to <code>/etc</code> which will be discarded.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="default-persistent-paths">Default persistent paths<a href="#default-persistent-paths" class="hash-link" aria-label="Direct link to Default persistent paths" title="Direct link to Default persistent paths" translate="no">â€‹</a></h2>
<p>Other than the <code>/usr/local</code> path, Kairos will also bind mount the following paths to the persistent partition under <code>/usr/local/.state</code> to make them persistent and read/write:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/etc/cni</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/etc/init.d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/etc/iscsi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/etc/k0s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/etc/kubernetes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/etc/modprobe.d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/etc/pwx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/etc/rancher</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/etc/runlevels</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/etc/ssh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/etc/ssl/certs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/etc/sysconfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/etc/systemd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/etc/zfs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/home</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/libexec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/cores</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/lib/ca</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">certificates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/lib/cni</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/lib/containerd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/lib/calico</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/lib/dbus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/lib/etcd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/lib/extensions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/lib/k0s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/lib/kubelet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/lib/longhorn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/lib/osd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/lib/rancher</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/lib/rook</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/lib/tailscale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/lib/wicked</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/lib/kairos</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/log</span><br></span></code></pre></div></div>
<p>Some specific distros have additional paths, for example:</p>
<ul>
<li class="">For Ubuntu/Debian, <code>/snap</code>, <code>/var/snap</code> and <code>/var/lib/snapd</code></li>
<li class="">For Red Hat/Fedora/Rockylinux/Almalinux <code>/usr/share/pki/trust</code> and <code>/usr/share/pki/trust/anchors</code></li>
</ul>
<p>For the most up-to-date list of paths, please refer to the <a href="https://github.com/kairos-io/kairos-init/blob/main/pkg/bundled/cloudconfigs/00_rootfs.yaml#L13" target="_blank" rel="noopener noreferrer" class="">default rootfs configuration</a> and the <a href="https://github.com/kairos-io/kairos-init/blob/main/pkg/bundled/cloudconfigs/01_extra_binds.yaml" target="_blank" rel="noopener noreferrer" class="">extra bind mounts configuration</a> files.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>You can add additional paths to the persistent partition by using the <a class="" href="/kairos-docs/docs/reference/configuration">bind_mounts configuration option</a>. This is useful for storing additional data that you want to persist across reboots or upgrades.</p></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="benefits-of-using-an-immutable-system">Benefits of using an Immutable System<a href="#benefits-of-using-an-immutable-system" class="hash-link" aria-label="Direct link to Benefits of using an Immutable System" title="Direct link to Benefits of using an Immutable System" translate="no">â€‹</a></h2>
<p>There are many reasons why you would like to use an immutable system, in this article we&#x27;ll present two of them.</p>
<ol>
<li class="">From a security standpoint, it&#x27;s far more secure than traditional systems. This is because most attack vectors rely on writing on the system, or installing persistent tools after a vector has been exploited.</li>
<li class="">From a maintenance perspective, configuration management tools like Chef, Puppet, or the likes aren&#x27;t needed because immutable systems only have one configuration entry point. Every other configuration is cleaned up automatically after a reboot.</li>
</ol>
<p>The benefit of rolling out the same system over a set of machines are the following:</p>
<ul>
<li class=""><strong>No snowflakes</strong> - All the machines are based on the same image, configuration settings and behavior. This allows to have a predictable infrastructure, predictable upgrades, and homogeneous configurations across your cluster.</li>
<li class=""><strong>Configuration is driven via cloud-init</strong> - There is only one source of truth for the configuration, and that happens at bootstrap time. Anything else is handled afterwardsâ€”natively via Kubernetes, so no configuration management software is required.</li>
<li class=""><strong>Reduced attack surface</strong> - Immutable systems cannot be modified or tampered at runtime. This enhances the security of a running OS, as changes on the system are not allowed.</li>
</ul>
<p>Tools like Chef, Puppet, and Ansible share the same underlying issues when it comes to configuration management. That is, nodes can have different version matrices of software and OS, which makes your set of nodes inhomogeneous and difficult to maintain and orchestrate from day 1 to day 2.</p>
<p>Kairos tackles the issue from different angle, as can turn <em>any</em> distribution to an &quot;immutable&quot; system, distributed as a standard container image, which gets provisioned to the devices as declared. This allows to treat OSes with the same repeatable portability as containers for apps, removing snowflakes in your cluster. Container registries can be used either internally or externally to the cluster to propagate upgrades with customized versions of the OS (kernel, packages, and so on).</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="design">Design<a href="#design" class="hash-link" aria-label="Direct link to Design" title="Direct link to Design" translate="no">â€‹</a></h2>
<p>Kairos after installation will create the following partitions:</p>
<ul>
<li class="">A state partition that stores the container images, which are going to be booted (active and passive, stored in <code>.img</code> format which are loopback mounted)</li>
<li class="">A recovery partition that stores the container images, used for recovery (in <code>.squashfs</code> format)</li>
<li class="">An OEM partition (optional) that stores user configuration and cloud-config files</li>
<li class="">A persistent partition to keep the data across reboots</li>
</ul>
<p><img decoding="async" loading="lazy" src="https://user-images.githubusercontent.com/2420543/195111190-3bdfb917-312a-40f4-b0bc-4a65a701c06b.png" alt="Kairos-installation-partitioning" class="img_ev3q"></p>
<p>The persistent partition is mounted during boot on <code>/usr/local</code>, and additional paths are mount-bind to it. Those configuration aspects are defined in a <a href="https://github.com/kairos-io/packages/blob/9b49d6aacd554cd990c87b63de1221328bbcdb81/packages/static/kairos-overlay-files/files/system/oem/00_rootfs.yaml#L18" target="_blank" rel="noopener noreferrer" class="">cloud-config</a> file. It is possible to override such configuration, via a custom cloud-config, during installation.</p>
<p>The Recovery system allows to perform emergency tasks, in case of failure from the active and passive images. Furthermore a fallback mechanism will take place, so that in case of failures the booting sequence will be as follows: &quot;A -&gt; B -&gt; Recovery&quot;.</p>
<p>The upgrade happens in a transition image and takes place only after all the necessary steps are completed. An upgrade of the &#x27;A/B&#x27; partitions can be done <a class="" href="/kairos-docs/docs/upgrade/kubernetes">with Kubernetes</a> or <a class="" href="/kairos-docs/docs/upgrade/manual">manually</a>. The upgrade will create a new pristine image, that will be selected as active for the next reboot, the old one will be flagged as passive. If we are performing the same from the passive system, only the active is subject to changes.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="kernel-and-initrd">Kernel and Initrd<a href="#kernel-and-initrd" class="hash-link" aria-label="Direct link to Kernel and Initrd" title="Direct link to Kernel and Initrd" translate="no">â€‹</a></h3>
<p>The Kernel and Initrd are loaded from the system images and are expected to be present in the container, that is pulled down and used for upgrades. Differently from standard approaches, Kairos focuses on having static Initrds, which are generated while building images used for upgrades - in opposite of generating Initramfs locally on the node. A typical setup has kernels and initrd in a special boot partition dedicated for boot files - in Kairos instead the Kernel and Initrd are being loaded from the images, which are chainloaded from the bootloader (GRUB). This is a design choice to keep the entire OS stack confined as a single layer which gets pulled and swapped atomically during upgrades.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/kairos-io/kairos-docs/tree/main/versioned_docs/version-3.5.7/Architecture/immutable.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-12-07T21:28:02.000Z" itemprop="dateModified">Dec 7, 2025</time></b> by <b>Jasper De Keukelaere (imec)</b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/kairos-docs/docs/3.5.7/category/architecture"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Architecture</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/kairos-docs/docs/3.5.7/Architecture/container"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Container</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#default-persistent-paths" class="table-of-contents__link toc-highlight">Default persistent paths</a></li><li><a href="#benefits-of-using-an-immutable-system" class="table-of-contents__link toc-highlight">Benefits of using an Immutable System</a></li><li><a href="#design" class="table-of-contents__link toc-highlight">Design</a><ul><li><a href="#kernel-and-initrd" class="table-of-contents__link toc-highlight">Kernel and Initrd</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/kairos-docs/docs/getting-started">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/kairos-docs/docs/installation">Installation</a></li><li class="footer__item"><a class="footer__link-item" href="/kairos-docs/docs/architecture">Architecture</a></li><li class="footer__item"><a class="footer__link-item" href="/kairos-docs/docs/examples">Examples</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://slack.cncf.io/#kairos" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/kairos-io/kairos/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/kairos-oss/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/Kairos_OSS" target="_blank" rel="noopener noreferrer" class="footer__link-item">X (Twitter)<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/kairos-docs/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/kairos-io/kairos" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.spectrocloud.com/solutions/kairos-support" target="_blank" rel="noopener noreferrer" class="footer__link-item">Commercial Support<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2025 Kairos authors</div></div></div></footer></div>
</body>
</html>