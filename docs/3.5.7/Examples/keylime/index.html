<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-3.5.7 docs-doc-page docs-doc-id-Examples/keylime" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Keylime agent | Kairos</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kairos.io/kairos-docs/img/Kairos_800x419.png"><meta data-rh="true" name="twitter:image" content="https://kairos.io/kairos-docs/img/Kairos_800x419.png"><meta data-rh="true" property="og:url" content="https://kairos.io/kairos-docs/docs/3.5.7/Examples/keylime"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="3.5.7"><meta data-rh="true" name="docusaurus_tag" content="docs-default-3.5.7"><meta data-rh="true" name="docsearch:version" content="3.5.7"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-3.5.7"><meta data-rh="true" property="og:title" content="Keylime agent | Kairos"><meta data-rh="true" name="description" content="This section describes an example on how to create a custom derivative with the Keylime agent"><meta data-rh="true" property="og:description" content="This section describes an example on how to create a custom derivative with the Keylime agent"><link data-rh="true" rel="icon" href="/kairos-docs/img/logo.svg"><link data-rh="true" rel="canonical" href="https://kairos.io/kairos-docs/docs/3.5.7/Examples/keylime"><link data-rh="true" rel="alternate" href="https://kairos.io/kairos-docs/docs/3.5.7/Examples/keylime" hreflang="en"><link data-rh="true" rel="alternate" href="https://kairos.io/kairos-docs/docs/3.5.7/Examples/keylime" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Examples","item":"https://kairos.io/kairos-docs/docs/3.5.7/category/examples"},{"@type":"ListItem","position":2,"name":"Keylime agent","item":"https://kairos.io/kairos-docs/docs/3.5.7/Examples/keylime"}]}</script><link rel="alternate" type="application/rss+xml" href="/kairos-docs/blog/rss.xml" title="Kairos RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/kairos-docs/blog/atom.xml" title="Kairos Atom Feed">




<script src="https://buttons.github.io/buttons.js" async defer="defer"></script><link rel="stylesheet" href="/kairos-docs/assets/css/styles.c9791132.css">
<script src="/kairos-docs/assets/js/runtime~main.f112c33f.js" defer="defer"></script>
<script src="/kairos-docs/assets/js/main.a6b903dc.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/kairos-docs/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/kairos-docs/"><div class="navbar__logo"><img src="/kairos-docs/img/logo.svg" alt="Kairos Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/kairos-docs/img/logo.svg" alt="Kairos Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Kairos</b></a><a class="navbar__item navbar__link" href="/kairos-docs/docs/getting-started">Getting Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/kairos-docs/docs/3.5.7/getting-started/">Documentation</a><a class="navbar__item navbar__link" href="/kairos-docs/blog">Blog</a><a href="https://kairos.io/community/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/kairos-docs/docs/3.5.7/Examples/keylime">3.5.7</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/kairos-docs/docs/next/Examples/keylime">Next ðŸš§</a></li><li><a class="dropdown__link" href="/kairos-docs/docs/3.6.0/Examples/keylime">3.6.0 (Latest)</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/kairos-docs/docs/3.5.7/Examples/keylime">3.5.7</a></li></ul></div><div class="navbar__item"><a class="github-button" href="https://github.com/kairos-io/kairos" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star kairos-io/kairos on GitHub">Star</a></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/kairos-docs/docs/3.5.7/getting-started/"><span title="Getting Started" class="categoryLinkLabel_W154">Getting Started</span></a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/kairos-docs/docs/3.5.7/category/installation"><span title="Installation" class="categoryLinkLabel_W154">Installation</span></a><button aria-label="Expand sidebar category &#x27;Installation&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/kairos-docs/docs/3.5.7/category/architecture"><span title="Architecture" class="categoryLinkLabel_W154">Architecture</span></a><button aria-label="Expand sidebar category &#x27;Architecture&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/kairos-docs/docs/3.5.7/category/examples"><span title="Examples" class="categoryLinkLabel_W154">Examples</span></a><button aria-label="Collapse sidebar category &#x27;Examples&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Examples/boot_assessment_trusted_boot"><span title="Enabling Automatic Boot Assessment with Trusted Boot" class="linkLabel_WmDU">Enabling Automatic Boot Assessment with Trusted Boot</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Examples/airgap"><span title="Airgapped ISO" class="linkLabel_WmDU">Airgapped ISO</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Examples/bandwidth-optimized-upgrades"><span title="Bandwidth Optimized Upgrades" class="linkLabel_WmDU">Bandwidth Optimized Upgrades</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Examples/bundles"><span title="Bundles" class="linkLabel_WmDU">Bundles</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Examples/core"><span title="Using Kairos Core Images as an Installer" class="linkLabel_WmDU">Using Kairos Core Images as an Installer</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Examples/extra_persistent_paths_after_install"><span title="Adding persistent paths after install" class="linkLabel_WmDU">Adding persistent paths after install</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Examples/ha"><span title="Manual multi-node HA cluster" class="linkLabel_WmDU">Manual multi-node HA cluster</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Examples/k3s-stages"><span title="Run stages along with K3s" class="linkLabel_WmDU">Run stages along with K3s</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Examples/kdump"><span title="Enabling kdump" class="linkLabel_WmDU">Enabling kdump</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/kairos-docs/docs/3.5.7/Examples/keylime"><span title="Keylime agent" class="linkLabel_WmDU">Keylime agent</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Examples/kubeadm-provider"><span title="A Minimal Single-Node Kubernetes with Kubeadm" class="linkLabel_WmDU">A Minimal Single-Node Kubernetes with Kubeadm</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Examples/localai"><span title="LocalAI" class="linkLabel_WmDU">LocalAI</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Examples/metallb"><span title="MetalLB" class="linkLabel_WmDU">MetalLB</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Examples/multi-node-p2p-ha-kubevip"><span title="Self-coordinating P2P multi-node cluster HA with KubeVIP" class="linkLabel_WmDU">Self-coordinating P2P multi-node cluster HA with KubeVIP</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Examples/multi-node-p2p-ha"><span title="Self-coordinating P2P multi-node cluster HA" class="linkLabel_WmDU">Self-coordinating P2P multi-node cluster HA</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Examples/multi-node-p2p"><span title="Self-coordinating P2P multi-node cluster" class="linkLabel_WmDU">Self-coordinating P2P multi-node cluster</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Examples/multi-node"><span title="Manual multi-node cluster" class="linkLabel_WmDU">Manual multi-node cluster</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Examples/openamt"><span title="Intel Open AMT Registration" class="linkLabel_WmDU">Intel Open AMT Registration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Examples/p2p_e2e"><span title="P2P multi-node cluster netboot" class="linkLabel_WmDU">P2P multi-node cluster netboot</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Examples/single-node-p2p"><span title="Self-configured P2P single-node cluster" class="linkLabel_WmDU">Self-configured P2P single-node cluster</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Examples/single-node"><span title="Manual single-node cluster" class="linkLabel_WmDU">Manual single-node cluster</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Examples/virtual-box"><span title="Trusted Boot in Virtual Box" class="linkLabel_WmDU">Trusted Boot in Virtual Box</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kairos-docs/docs/3.5.7/Examples/wifi"><span title="WiFi" class="linkLabel_WmDU">WiFi</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/kairos-docs/docs/3.5.7/category/advanced"><span title="Advanced" class="categoryLinkLabel_W154">Advanced</span></a><button aria-label="Expand sidebar category &#x27;Advanced&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/kairos-docs/docs/3.5.7/category/upgrade"><span title="Upgrade" class="categoryLinkLabel_W154">Upgrade</span></a><button aria-label="Expand sidebar category &#x27;Upgrade&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/kairos-docs/docs/3.5.7/category/reference"><span title="Reference" class="categoryLinkLabel_W154">Reference</span></a><button aria-label="Expand sidebar category &#x27;Reference&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/kairos-docs/docs/3.5.7/category/development"><span title="Development" class="categoryLinkLabel_W154">Development</span></a><button aria-label="Expand sidebar category &#x27;Development&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Kairos<!-- --> <b>3.5.7</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/kairos-docs/docs/3.6.0/Examples/keylime">latest version</a></b> (<!-- -->3.6.0 (Latest)<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/kairos-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/kairos-docs/docs/3.5.7/category/examples"><span>Examples</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Keylime agent</span></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 3.5.7</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Keylime agent</h1></header><p>This example how to use Keylime with Kairos in order to provide verified measurement for runtime binaries or files in a Kairos system. This, for instance involve having measurements for specific files in the persistent portion of the disk, or the configuration directories.</p>
<p>Most of the steps are already covered in the <a href="https://keylime-docs.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer" class="">Keylime documentation</a>. Here we will cover the steps that are specific to Kairos.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="extend-kairos">Extend Kairos<a href="#extend-kairos" class="hash-link" aria-label="Direct link to Extend Kairos" title="Direct link to Extend Kairos" translate="no">â€‹</a></h2>
<p>First of all we need to create a Kairos derivative with the keylime agent, in order to do this we use the <a href="https://kairos.io/docs/reference/kairos-factory/" target="_blank" rel="noopener noreferrer" class="">Kairos factory process</a> where we will build our own OS derivative to bundle keylime-agent:</p>
<div class="language-Dockerfile language-dockerfile codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Build the keylime agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM ubuntu:24.04 AS keylime-build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends ca-certificates git gcc libclang-dev libssl-dev libtss2-dev libzmq3-dev pkg-config rustup make &amp;&amp; rm -rf /var/lib/apt/lists/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WORKDIR /keylime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN git clone --depth 1 --branch v0.2.7 https://github.com/keylime/rust-keylime.git /keylime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Set up install destination dir so we can reuse the build artifacts for our Kairos image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENV DESTDIR=/keylime-output</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN rustup default stable &amp;&amp; make &amp;&amp; make install</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Build the final image with the keylime agent copied over, only systemd supported for now</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM quay.io/kairos/rockylinux:9-core-amd64-generic-v3.4.1 AS default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY --from=keylime-build /keylime-output/ /</span><br></span></code></pre></div></div>
<p>Then you can build your image with the agent on it:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker build -t kairos-keylime .</span><br></span></code></pre></div></div>
<p>That will generate an artifact based on the Kairos image with the keylime-agent installed.</p>
<p>Then you need at a minimum the follow configuration in your cloud config:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#cloud-config</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">install</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">auto</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">reboot</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">device</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /dev/vda</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">bind_mounts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> /var/lib/keylime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">grub_options</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">extra_cmdline</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ima_appraise=fix ima_template=ima-ng ima_policy=custom&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># custom policy will load it from /etc/ima/ima-policy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">stages</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">initramfs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Set user and password&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">users</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token key atrule" style="color:#00a4db">kairos</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">passwd</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;kairos&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">groups</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;admin&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token key atrule" style="color:#00a4db">keylime</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">groups</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tss&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">hostname</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;kairos-keylime&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">files</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Set default IMA policy </span><span class="token comment" style="color:#999988;font-style:italic"># In initramfs as the kernel will load it on rootfs pivot</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             </span><span class="token key atrule" style="color:#00a4db">path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /etc/ima/ima</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">policy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             </span><span class="token key atrule" style="color:#00a4db">permissions</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0644</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             </span><span class="token key atrule" style="color:#00a4db">content</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                # PROC_SUPER_MAGIC</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                dont_measure fsmagic=0x9fa0</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                # SYSFS_MAGIC</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                dont_measure fsmagic=0x62656572</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                # DEBUGFS_MAGIC</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                dont_measure fsmagic=0x64626720</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                # TMPFS_MAGIC</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                dont_measure fsmagic=0x01021994</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                # RAMFS_MAGIC</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                dont_measure fsmagic=0x858458f6</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                # SECURITYFS_MAGIC</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                dont_measure fsmagic=0x73636673</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                # SELINUX_MAGIC</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                dont_measure fsmagic=0xf97cff8c</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                # CGROUP_SUPER_MAGIC</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                dont_measure fsmagic=0x27e0eb</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                # OVERLAYFS_MAGIC</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                # when containers are used we almost always want to ignore them</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                dont_measure fsmagic=0x794c7630</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                # MEASUREMENTS</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                # This covers regular binary execution (e.g., running an ELF file with execve).</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                measure func=BPRM_CHECK</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                # Captures JIT-executed or interpreted code and shared libraries mapped into memory with executable permission.</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                measure func=FILE_MMAP mask=MAY_EXEC</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                # Tracks all kernel modules loaded by root, which is crucial for maintaining kernel integrity.</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                measure func=MODULE_CHECK uid=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                # Measures all files that are read, written, or appended to.</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                measure func=FILE_CHECK mask=MAY_READ</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                measure func=FILE_CHECK mask=MAY_WRITE</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                measure func=FILE_CHECK mask=MAY_APPEND</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">boot</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Set Keylime config&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">files</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /var/lib/keylime/cv_ca/cacert.crt </span><span class="token comment" style="color:#999988;font-style:italic"># This is the cert from the Keylime registrar/tenant server. The clients need to trust it.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             </span><span class="token key atrule" style="color:#00a4db">content</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                -----BEGIN CERTIFICATE-----</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                MIID8zCCAtugAwIBAgIBATANBgkqhkiG9w0BAQsFADBzMQswCQYDVQQGEwJVUzEm</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                MCQGA1UEAwwdS2V5bGltZSBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkxCzAJBgNVBAgM</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                Ak1BMRIwEAYDVQQHDAlMZXhpbmd0b24xDjAMBgNVBAoMBU1JVExMMQswCQYDVQQL</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                DAI1MzAeFw0yNTA3MDQwODIxMThaFw0zNTA3MDIwODIxMThaMHMxCzAJBgNVBAYT</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                AlVTMSYwJAYDVQQDDB1LZXlsaW1lIENlcnRpZmljYXRlIEF1dGhvcml0eTELMAkG</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                A1UECAwCTUExEjAQBgNVBAcMCUxleGluZ3RvbjEOMAwGA1UECgwFTUlUTEwxCzAJ</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                BgNVBAsMAjUzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqdMRFikV</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                w65U0B213Zscps3ODEXPkZgFFf5Uyv9Md9kV5zMSWk0Em/HTUUiixVz8o7+soK7f</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                SZezKg8Je/Sy1eZlRLR7ijHQyHmFByMcHiBry8FhaHelP1bfUNVHY9PkTYX1i7Cb</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                yXiSwD2x467Ao8KwZWNR01d9rDMwWSV73scddRt9hLaI8BWaTptpaC3tpQhvo4K9</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                LrYsOxpgoFGyMU09Ds5BOqt5IaU3DkY2bfkSy6D9W4GVzk56u0RHevy6kTA6DARK</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                wDYlo+z/mgylLZsxD+r5VwxLjoXT1e+M2T4H/F2T/FPh5BLNngXOfaJl0YP9amLM</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                oopARJ04qKO5pwIDAQABo4GRMIGOMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYE</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                FE3BrSsveBPSY5ct2MLvIobGDDtSMCsGA1UdHwQkMCIwIKAeoByGGmh0dHA6Ly9s</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                b2NhbGhvc3Q6MzgwODAvY3JsMA4GA1UdDwEB/wQEAwIBBjAfBgNVHSMEGDAWgBRN</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                wa0rL3gT0mOXLdjC7yKGxgw7UjANBgkqhkiG9w0BAQsFAAOCAQEACk//H5DDy/F6</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                fqp7Ar3tWtTsrPiDmNo3P1w6u8dstuyfcfbHDi8HaN0YN2a837ya0eF4WzLIpo/b</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                Ft4hNboGTIBQbcVsQ6sm6JY7ioI/eEiaHO0FeyIFfTy/oj00if5SZ1AT/cpumTCm</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                NapygE7EZYzQU8VW1wLKZlOb0KvuBaLbfsfpFB05ZB1PYyxETTuZvs93vEs/huay</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                HolE8pIl1eHE6fFcEeBtmnOGOMHHcITlmyjdzSuL/Z3aDmXxuQN5y/cyO2t3MQ24</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                i100gwrCtRGLmJo4cTr/57/KO8PkSZaNhWuLOfzLggBMHL6uXUr2Q8FBgTc/hUaX</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                AZTsa1FQAA==</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                -----END CERTIFICATE-----</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             </span><span class="token key atrule" style="color:#00a4db">permissions</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0644</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /etc/keylime/agent.conf.d/10</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">config.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             </span><span class="token key atrule" style="color:#00a4db">content</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                [agent]</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                ip = &#x27;0.0.0.0&#x27; # This is the IP the agent will listen on, change if needed</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                registrar_ip = &#x27;192.168.122.31&#x27; # change to the keylime remote attestation server IP</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                uuid = &#x27;61388a67-baa4-4f2b-8221-d539b7b4d98b&#x27; # Generate an uuid with `uuidgen` or similar</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             </span><span class="token key atrule" style="color:#00a4db">permissions</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0640</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Set keylime owner to /var/lib/keylime&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">commands</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> chown </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">R keylime</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">keylime /var/lib/keylime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">network</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Enable keylime_agent service&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># This will request activation but does not ADD the node and starts attestation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">systemctl</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token key atrule" style="color:#00a4db">enable</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> keylime_agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token key atrule" style="color:#00a4db">start</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> keylime_agent</span><br></span></code></pre></div></div>
<p>Lets go a bit into detail of some of the options.</p>
<ul>
<li class=""><code>bind_mounts</code>: This is required for the keylime-agent to store the keys and certificates. It needs to be persisted across reboots.</li>
<li class=""><code>extra_cmdline</code>: This is required to enable the IMA appraisal in the kernel. This is required for keylime to work if you expect to use runtime attestation and a custom IMA policy.</li>
<li class=""><code>users</code>: We add the keylime user as the default keylime agent service will drop privileges to this user. Has to have the <code>tss</code> group as well.</li>
<li class=""><code>/etc/ima/ima-policy</code>: This is the custom IMA policy that the kernel will use. The one provided is just a generic example.</li>
<li class=""><code>/var/lib/keylime</code> ownership: The keylime agent will need to write to this directory. It is important to set the correct ownership. We do it at the end so all the written files are owned by the keylime user.</li>
<li class=""><code>systemctl</code>: We want to enable and start the keylime_agent service so it starts on boot and is running.</li>
<li class=""><code>/etc/keylime/agent.conf.d/10-config.conf</code>: This is the keylime agent configuration. Keylime agent provides a default config and we use this to override those default values. Minimal values that need configuring here are as follows:<!-- -->
<ul>
<li class=""><code>ip</code>: The IP address the agent will listen on. This should be set to <code>0.0.0.0</code> to listen on all interfaces or to the specific interface IP address if you know it on advance. Otherwise it will only listen on the loopback interface and won&#x27;t be reachable from the outside.</li>
<li class=""><code>registrar_ip</code>: The IP address of the keylime registrar server. Otherwise the agent will not be able to communicate with the registrar.</li>
<li class=""><code>uuid</code>: The UUID of the agent. This is used to identify the agent in the registrar. This can be any UUID as long as it is unique in the registrar server. If you set it to &#x27;generate&#x27; it will generate a random UUID for you but thatâ€™s not currently supported in Kairos. You can generate a UUID with <code>uuidgen</code> or similar tools.</li>
<li class=""><code>/var/lib/keylime/cv_ca/cacert.crt</code>: This is the CA certificate that the agent will use to verify the registrar server. This is required for the agent to be able to communicate with the registrar server securely. You can get this certificate from the Keylime registrar server.</li>
</ul>
</li>
</ul>
<p>With this values, building a derivative image and installing it should be enough to have the keylime agent running in Kairos.
Now you will need to add the agent to the Keylime registrar, as its currently activated but not added. You can do this from the Keylime tenant by running the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ keylime_tenant -c add --uuid UID_OF_AGENT --ip IP_OF_AGENT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">....</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-07-08 12:50:19.728 - keylime.tenant - INFO - Agent Info from Verifier (127.0.0.1:8881):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;61388a67-baa4-4f2b-8221-d539b7b4d98b&quot;: {&quot;operational_state&quot;: &quot;Start&quot;, &quot;v&quot;: null, &quot;ip&quot;: &quot;192.168.122.47&quot;, &quot;port&quot;: 9002, &quot;tpm_policy&quot;: &quot;{\&quot;mask\&quot;: \&quot;0x0\&quot;}&quot;, &quot;meta_data&quot;: &quot;{}&quot;, &quot;has_mb_refstate&quot;: 0, &quot;has_runtime_policy&quot;: 0, &quot;accept_tpm_hash_algs&quot;: [&quot;sha512&quot;, &quot;sha384&quot;, &quot;sha256&quot;], &quot;accept_tpm_encryption_algs&quot;: [&quot;ecc&quot;, &quot;rsa&quot;], &quot;accept_tpm_signing_algs&quot;: [&quot;ecschnorr&quot;, &quot;rsassa&quot;], &quot;hash_alg&quot;: &quot;&quot;, &quot;enc_alg&quot;: &quot;&quot;, &quot;sign_alg&quot;: &quot;&quot;, &quot;verifier_id&quot;: &quot;default&quot;, &quot;verifier_ip&quot;: &quot;127.0.0.1&quot;, &quot;verifier_port&quot;: 8881, &quot;severity_level&quot;: null, &quot;last_event_id&quot;: null, &quot;attestation_count&quot;: 0, &quot;last_received_quote&quot;: 0, &quot;last_successful_attestation&quot;: 0}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-07-08 12:50:19.728 - keylime.tenant - INFO - Agent 61388a67-baa4-4f2b-8221-d539b7b4d98b (192.168.122.47:9002) added to Verifier (127.0.0.1:8881) after 0 tries</span><br></span></code></pre></div></div>
<p>Where <code>UID_OF_AGENT</code> is the UUID you set in the agent configuration and <code>IP_OF_AGENT</code> is the IP address of the agent.</p>
<blockquote>
<p>you can add <code>--cert default</code> to provision the node with the default certificates from the registrar, like the revocation certificat and such. This is very helpful so further steps down the line can be done without having to worry about the certificates.</p>
</blockquote>
<p>Now from the tenant you can apply any policy you want to the agent. Note that the agent will start the attestation but there is no actual policy applied by default, so it will not fail the attestation process. It will just continue to run and report its state as valid.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="using-a-runtime-policy">Using a runtime policy<a href="#using-a-runtime-policy" class="hash-link" aria-label="Direct link to Using a runtime policy" title="Direct link to Using a runtime policy" translate="no">â€‹</a></h2>
<p>As an example, you can use <code>keylime-policy</code> to create a runtime policy that will be applied to the agent. This policy can be as simple or as complex as you want, depending on your security requirements.</p>
<blockquote>
<p>A runtime policy in its most basic form is a set of â€œgoldenâ€ cryptographic hashes of filesâ€™ un-tampered state or of keys
that may be loaded onto keyrings for IMA verification</p>
</blockquote>
<p>Exclude list that excludes everything except the <code>/usr/local/</code> and <code>/oem/</code> directories (perfect for Kairos <!-- -->:D<!-- -->):</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">^/(?!oem/|usr/local/)</span><br></span></code></pre></div></div>
<p>Or an exclude list that just excludes the directories that are not relevant for the runtime policy (files that keep changing, like logs, temporary files, etc.):</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">^/var/log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.bash_history</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">^/sys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">^/tmp</span><br></span></code></pre></div></div>
<p>First from the node, we can copy the IMA ascii measure list and scp it to the Keylime tenant server:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ scp /sys/kernel/security/ima/ascii_runtime_measurements root@TENANT_IP:/root/runtime_measurements</span><br></span></code></pre></div></div>
<p>Then on the tenant server, we can generate a policy from this list using the <code>keylime-policy</code> command. This command will create a policy based on the measurements in the file we just copied.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ keylime-policy create runtime --ima-measurement-list runtime_measurements -e excludelist.txt -o policy.json -v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO:keylime.config:Reading configuration from [&#x27;/etc/keylime/logging.conf&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-07-10 14:54:30.467 - keylime-policy - DEBUG - Measurement list is runtime_measurements</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-07-10 14:54:30.468 - keylime-policy - DEBUG - Using digest algorithm &#x27;sha256&#x27; obtained from the IMA measurement list</span><br></span></code></pre></div></div>
<p>Now we can apply policy to the agent. You can use the <code>keylime_tenant</code> command to do this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">keylime_tenant --command update -u 61388a67-baa4-4f2b-8221-d539b7b4d98b -t 192.168.122.47 --runtime-policy policy.json </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO:keylime.config:Reading configuration from [&#x27;/etc/keylime/logging.conf&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-07-09 15:20:42.578 - keylime.config - INFO - Reading configuration from [&#x27;/etc/keylime/tenant.conf&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-07-09 15:20:42.578 - keylime.config - INFO - Applied configuration snippets from /etc/keylime/tenant.conf.d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-07-09 15:20:42.578 - keylime.tenant - INFO - Setting up client TLS...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-07-09 15:20:42.578 - keylime.tenant - INFO - Using default client_cert option for tenant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-07-09 15:20:42.578 - keylime.tenant - INFO - Using default client_key option for tenant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-07-09 15:20:42.578 - keylime.tenant - INFO - No value provided in client_key_password option for tenant, assuming the key is unencrypted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-07-09 15:20:42.579 - keylime.tenant - INFO - TLS is enabled.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-07-09 15:20:42.593 - keylime.cli.policies - INFO - TPM PCR Mask from policy is 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-07-09 15:20:42.643 - keylime.tenant - INFO - Agent Info from Verifier (127.0.0.1:8881):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;61388a67-baa4-4f2b-8221-d539b7b4d98b&quot;: {&quot;operational_state&quot;: &quot;Terminated&quot;, &quot;v&quot;: null, &quot;ip&quot;: &quot;192.168.122.47&quot;, &quot;port&quot;: 9002, &quot;tpm_policy&quot;: &quot;{\&quot;mask\&quot;: \&quot;0x0\&quot;}&quot;, &quot;meta_data&quot;: &quot;{}&quot;, &quot;has_mb_refstate&quot;: 0, &quot;has_runtime_policy&quot;: 0, &quot;accept_tpm_hash_algs&quot;: [&quot;sha512&quot;, &quot;sha384&quot;, &quot;sha256&quot;], &quot;accept_tpm_encryption_algs&quot;: [&quot;ecc&quot;, &quot;rsa&quot;], &quot;accept_tpm_signing_algs&quot;: [&quot;ecschnorr&quot;, &quot;rsassa&quot;], &quot;hash_alg&quot;: &quot;sha256&quot;, &quot;enc_alg&quot;: &quot;rsa&quot;, &quot;sign_alg&quot;: &quot;rsassa&quot;, &quot;verifier_id&quot;: &quot;default&quot;, &quot;verifier_ip&quot;: &quot;127.0.0.1&quot;, &quot;verifier_port&quot;: 8881, &quot;severity_level&quot;: null, &quot;last_event_id&quot;: null, &quot;attestation_count&quot;: 78, &quot;last_received_quote&quot;: 1752066297, &quot;last_successful_attestation&quot;: 1752066297}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;code&#x27;: 200, &#x27;status&#x27;: &#x27;Success&#x27;, &#x27;results&#x27;: {&#x27;quote&#x27;: &#x27;r/1RDR4AYACIAC4hWOYdkG4M3v+tpIFyj2HOcpM/hnxJNsfc3rT9r4S5BABRkWnVQd1Rja3VPUjlBeUhyeWRPagAAAAAF6sI1AAAABgAAAAABICQBJQASAAAAAAABAAsDAAABACBYQwK8jVUDbMvZmLPw0tE7unP+d4sVDS8/pqmkT+gkag==:ABQACwEACQih/HZ/9JO3/hCwGmE6LSojc/nYQgskf4t/6OGB3ed/3kyysUMYrSXtw38FoZA+uu/7YTEaW+qWzf/KVPjOU5GJUB1B2StdSv570hTps7InxxDXhphIFH/KI5f1OdEK5c8o09b/IpZ/nGdYmp3GnowAivm+9y/0xarRA5GMUiVWdJT7LhZMQvxRXG/Yhb5zwoewpFecmbcNZ7/t0qpFfEpifwhP/yhp1wPTdUds774hlPhy5PAXFFYnTVcDn8TN0a8tBENtA/tewx3i6pxhIggW/miNyzgdKrQyIBCXgYr8U8zykk0DjTnWVeML3lzEj3CGZ1HTmu3l512juxv32A==:AQAAAAsAAwAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAgADOY31045T1AWJQ9mnWd1S0uBPHVWocFH54zRICCX9KnAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=&#x27;, &#x27;hash_alg&#x27;: &#x27;sha256&#x27;, &#x27;enc_alg&#x27;: &#x27;rsa&#x27;, &#x27;sign_alg&#x27;: &#x27;rsassa&#x27;, &#x27;pubkey&#x27;: &#x27;-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAm2R9EoaB0qhdKg+RbtJy\nYPbCM3CgxpnscdY0Eyv5WPfmkuJ9/9h/vWnqBDmxfXrZEhYlZIUrfyUjbNUyckz5\nXGgWpDZjNE+srxT7qwrUrCLpCvYSlHiLko6s4yinUKO0LPKQ1f41ATYd1JO3gXyD\nx8CabBqorSREz+KDO9uyUJyszL8lK0zLMAKXt/ZB3ZS76OmpmwBcQGpn0VtYHYl1\n584A4nStMIlNQET6QsQ70QIm5sTgaTGqrLoEHkQP7a1J9RfcHYrxqYg4dEgTEER7\nkPuLTKAGSdfqYzvOAIDqSsn3BxS1hC1TQ+ln6MprJSKG23VpMK1Q0PyTee7FvxVz\ntQIDAQAB\n-----END PUBLIC KEY-----\n&#x27;}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-07-09 15:20:42.849 - keylime.tenant - WARNING - DANGER: EK cert checking is disabled and no additional checks on EKs have been specified with ek_check_script option for Agent 61388a67-baa4-4f2b-8221-d539b7b4d98b (192.168.122.47:9002). Keylime is not secure!!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-07-09 15:20:42.849 - keylime.tenant - INFO - Quote from Agent 61388a67-baa4-4f2b-8221-d539b7b4d98b (192.168.122.47:9002) validated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-07-09 15:20:43.268 - keylime.tenant - INFO - Agent Info from Verifier default (127.0.0.1:8881):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;61388a67-baa4-4f2b-8221-d539b7b4d98b&quot;: {&quot;operational_state&quot;: &quot;Start&quot;, &quot;v&quot;: null, &quot;ip&quot;: &quot;192.168.122.47&quot;, &quot;port&quot;: 9002, &quot;tpm_policy&quot;: &quot;{\&quot;mask\&quot;: \&quot;0x400\&quot;}&quot;, &quot;meta_data&quot;: &quot;{}&quot;, &quot;has_mb_refstate&quot;: 0, &quot;has_runtime_policy&quot;: 1, &quot;accept_tpm_hash_algs&quot;: [&quot;sha512&quot;, &quot;sha384&quot;, &quot;sha256&quot;], &quot;accept_tpm_encryption_algs&quot;: [&quot;ecc&quot;, &quot;rsa&quot;], &quot;accept_tpm_signing_algs&quot;: [&quot;ecschnorr&quot;, &quot;rsassa&quot;], &quot;hash_alg&quot;: &quot;&quot;, &quot;enc_alg&quot;: &quot;&quot;, &quot;sign_alg&quot;: &quot;&quot;, &quot;verifier_id&quot;: &quot;default&quot;, &quot;verifier_ip&quot;: &quot;127.0.0.1&quot;, &quot;verifier_port&quot;: 8881, &quot;severity_level&quot;: null, &quot;last_event_id&quot;: null, &quot;attestation_count&quot;: 0, &quot;last_received_quote&quot;: 0, &quot;last_successful_attestation&quot;: 0}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-07-09 15:20:43.268 - keylime.tenant - INFO - Agent 61388a67-baa4-4f2b-8221-d539b7b4d98b (192.168.122.47:9002) added to Verifier default (127.0.0.1:8881) after 0 tries</span><br></span></code></pre></div></div>
<p>This will apply the runtime policy to the agent and the agent will start the attestation process. You can see this in the agent logs:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Jul 10 12:55:39 localhost keylime_agent[1551]:  INFO  keylime_agent                        &gt; GET invoked from &quot;192.168.122.31&quot; with uri /v2.1/quotes/integrity?nonce=TMywGq9gEgYy8QaptsB1&amp;mask=0x400&amp;partial=1&amp;ima_ml_entry=1739</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 10 12:55:39 localhost keylime_agent[1551]:  INFO  keylime_agent::quotes_handler        &gt; GET integrity quote returning 200 response</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 10 12:55:41 localhost keylime_agent[1551]:  INFO  keylime_agent                        &gt; GET invoked from &quot;192.168.122.31&quot; with uri /v2.1/quotes/integrity?nonce=eyI1bo2HpS081kM1FbnQ&amp;mask=0x400&amp;partial=1&amp;ima_ml_entry=1739</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 10 12:55:42 localhost keylime_agent[1551]:  INFO  keylime_agent::quotes_handler        &gt; GET integrity quote returning 200 response</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 10 12:55:44 localhost keylime_agent[1551]:  INFO  keylime_agent                        &gt; GET invoked from &quot;192.168.122.31&quot; with uri /v2.1/quotes/integrity?nonce=3TStNCteiVm5NC0dCraW&amp;mask=0x400&amp;partial=1&amp;ima_ml_entry=1739</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 10 12:55:44 localhost keylime_agent[1551]:  INFO  keylime_agent::quotes_handler        &gt; GET integrity quote returning 200 response</span><br></span></code></pre></div></div>
<p>You can also check on the verifier logs that the agent is in the correct state:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jul 10 14:57:06 keylime keylime_verifier[1410]: 2025-07-10 14:57:06.216 - keylime.tpm - INFO - Checking IMA measurement list on agent: 61388a67-baa4-4f2b-8221-d539b7b4d98b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jul 10 14:57:08 keylime keylime_verifier[1410]: 2025-07-10 14:57:08.449 - keylime.tpm - INFO - Checking IMA measurement list on agent: 61388a67-baa4-4f2b-8221-d539b7b4d98b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jul 10 14:57:10 keylime keylime_verifier[1410]: 2025-07-10 14:57:10.637 - keylime.tpm - INFO - Checking IMA measurement list on agent: 61388a67-baa4-4f2b-8221-d539b7b4d98b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jul 10 14:57:12 keylime keylime_verifier[1410]: 2025-07-10 14:57:12.854 - keylime.tpm - INFO - Checking IMA measurement list on agent: 61388a67-baa4-4f2b-8221-d539b7b4d98b</span><br></span></code></pre></div></div>
<p>Now we can test the revocation of the agent once a file is modified. We will change the /oem/90_custom.yaml and change a value in there:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ sed -i &#x27;s/reboot: true/reboot: false/&#x27; /oem/90_custom.yaml</span><br></span></code></pre></div></div>
<p>Sure enough, in a few seconds the agent will be revoked and you can see this in the verifier logs:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jul 10 15:00:00 keylime keylime_verifier[1410]: 2025-07-10 15:00:00.941 - keylime.tpm - INFO - Checking IMA measurement list on agent: 61388a67-baa4-4f2b-8221-d539b7b4d98b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jul 10 15:00:03 keylime keylime_verifier[1410]: 2025-07-10 15:00:03.153 - keylime.tpm - INFO - Checking IMA measurement list on agent: 61388a67-baa4-4f2b-8221-d539b7b4d98b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jul 10 15:00:03 keylime keylime_verifier[1410]: 2025-07-10 15:00:03.153 - keylime.ima - WARNING - Hashes for file /oem/90_custom.yaml don&#x27;t match 97356fb8edc035052bac594306d0fdcef99f28e42703acaafa8d7940868b60d0 not in [&#x27;046209cb4acb79d533a9c6a9845766d4f435bc059f45421ed6e1cceb9c2dcc2e&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jul 10 15:00:03 keylime keylime_verifier[1410]: 2025-07-10 15:00:03.153 - keylime.ima - ERROR - IMA ERRORS: Some entries couldn&#x27;t be validated. Number of failures in modes: ImaNg 1.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jul 10 15:00:03 keylime keylime_verifier[1410]: 2025-07-10 15:00:03.187 - keylime.verifier - WARNING - Agent 61388a67-baa4-4f2b-8221-d539b7b4d98b failed, stopping polling</span><br></span></code></pre></div></div>
<p>You can also see this in the agent logs:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Jul 10 13:00:02 localhost keylime_agent[1551]:  INFO  keylime_agent                        &gt; GET invoked from &quot;192.168.122.31&quot; with uri /v2.1/quotes/integrity?nonce=9Ovk0YVjEp2bXollI76m&amp;mask=0x400&amp;partial=1&amp;ima_ml_entry=1746</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 10 13:00:02 localhost keylime_agent[1551]:  INFO  keylime_agent::quotes_handler        &gt; GET integrity quote returning 200 response</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 10 13:00:02 localhost keylime_agent[1551]:  INFO  keylime_agent                        &gt; POST invoked from &quot;192.168.122.31&quot; with uri /v2.1/notifications/revocation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 10 13:00:02 localhost keylime_agent[1551]:  INFO  keylime_agent::notifications_handler &gt; Received revocation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 10 13:00:02 localhost keylime_agent[1551]:  WARN  keylime_agent::revocation            &gt; Revocation certificate not yet available</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="using-a-tpm-policy-instead">Using a TPM policy instead<a href="#using-a-tpm-policy-instead" class="hash-link" aria-label="Direct link to Using a TPM policy instead" title="Direct link to Using a TPM policy instead" translate="no">â€‹</a></h2>
<p>As an example, we add a policy that will only allow the agent to boot if the PCR 15 is equal to a specific value (in this case empty value as we haven&#x27;t measured anything into PCR15):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ keylime_tenant -c update --uuid UID_OF_AGENT -t IP_OF_AGENT  --tpm_policy &#x27;{&quot;15&quot;:[&quot;0000000000000000000000000000000000000000&quot;,&quot;0000000000000000000000000000000000000000000000000000000000000000&quot;,&quot;000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;]}&#x27;</span><br></span></code></pre></div></div>
<p>Then the agent will start the attestation process, which you can see both in the agent logs and in the verifier logs. As well as checking with the tenant that the agent is in the correct state.</p>
<p>Then to test the revocation you can extend the PCR15 manually:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ tpm2_pcrextend 15:sha256=f1d2d2f924e986ac86fdf7b36c94bcdf32beec15324234324234234333333333</span><br></span></code></pre></div></div>
<p>Then the verifier will see that the agent is not in the correct state and will revoke it. You can see this in the verifier logs:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2025-07-10 15:05:15.296 - keylime.tenant - INFO - Agent Info from Verifier (127.0.0.1:8881):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;61388a67-baa4-4f2b-8221-d539b7b4d98b&quot;: {&quot;operational_state&quot;: &quot;Invalid Quote&quot;, &quot;v&quot;: null, &quot;ip&quot;: &quot;192.168.122.47&quot;, &quot;port&quot;: 9002, &quot;tpm_policy&quot;: &quot;{\&quot;15\&quot;: [\&quot;0000000000000000000000000000000000000000\&quot;, \&quot;0000000000000000000000000000000000000000000000000000000000000000\&quot;, \&quot;000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\&quot;], \&quot;mask\&quot;: \&quot;0x8000\&quot;}&quot;, &quot;meta_data&quot;: &quot;{}&quot;, &quot;has_mb_refstate&quot;: 0, &quot;has_runtime_policy&quot;: 0, &quot;accept_tpm_hash_algs&quot;: [&quot;sha512&quot;, &quot;sha384&quot;, &quot;sha256&quot;], &quot;accept_tpm_encryption_algs&quot;: [&quot;ecc&quot;, &quot;rsa&quot;], &quot;accept_tpm_signing_algs&quot;: [&quot;ecschnorr&quot;, &quot;rsassa&quot;], &quot;hash_alg&quot;: &quot;sha256&quot;, &quot;enc_alg&quot;: &quot;rsa&quot;, &quot;sign_alg&quot;: &quot;rsassa&quot;, &quot;verifier_id&quot;: &quot;default&quot;, &quot;verifier_ip&quot;: &quot;127.0.0.1&quot;, &quot;verifier_port&quot;: 8881, &quot;severity_level&quot;: 6, &quot;last_event_id&quot;: &quot;pcr_validation.invalid_pcr_15&quot;, &quot;attestation_count&quot;: 53, &quot;last_received_quote&quot;: 1752152713, &quot;last_successful_attestation&quot;: 1752152711}}</span><br></span></code></pre></div></div>
<p>You will also see on the agent logs that it has been revoked:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Jul 10 13:05:13 localhost keylime_agent[1741]:  INFO  keylime_agent::quotes_handler  &gt; GET integrity quote returning 200 response</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 10 13:05:13 localhost keylime_agent[1741]:  INFO  keylime_agent                  &gt; POST invoked from &quot;192.168.122.31&quot; with uri /v2.1/notifications/revocation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 10 13:05:13 localhost keylime_agent[1741]:  INFO  keylime_agent::notifications_handler &gt; Received revocation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 10 13:05:13 localhost keylime_agent[1741]:  WARN  keylime_agent::revocation            &gt; Revocation certificate not yet available</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="using-revocation-keys">Using revocation keys<a href="#using-revocation-keys" class="hash-link" aria-label="Direct link to Using revocation keys" title="Direct link to Using revocation keys" translate="no">â€‹</a></h2>
<p>In order to make the agent revocation process more secure, when registering the agent in the Keylime tenant, you need to pass a <code>--cert YOURCERT|default</code> option when adding the node. This will create a secure payload with the proper keys and scripts to be used for revocation and deliver it to the node. The agent will then use this payload to revoke itself when it detects a policy violation.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Jul 11 07:22:12 localhost keylime_agent[1756]:  DEBUG keylime_agent::keys_handler    &gt; Sent RunPayload message to payloads worker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 11 07:22:12 localhost keylime_agent[1756]:  DEBUG keylime_agent::keys_handler    &gt; Sent RunPayload message to payloads worker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 11 07:22:12 localhost keylime_agent[1756]:  INFO  keylime_agent::payloads        &gt; Successfully decrypted payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 11 07:22:12 localhost keylime_agent[1756]:  INFO  keylime_agent::payloads        &gt; Wrote payload decryption key to &quot;/var/lib/keylime/secure/unzipped/derived_tci_key&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 11 07:22:12 localhost keylime_agent[1756]:  INFO  keylime_agent::payloads        &gt; Wrote decrypted payload to &quot;/var/lib/keylime/secure/unzipped/decrypted_payload&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 11 07:22:12 localhost keylime_agent[1756]:  INFO  keylime_agent::payloads        &gt; Unzipping payload decrypted_payload to &quot;/var/lib/keylime/secure/unzipped&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 11 07:22:12 localhost keylime_agent[1756]:  INFO  keylime_agent::payloads        &gt; Payload init script indicated: autorun.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 11 07:22:12 localhost keylime_agent[1756]:  INFO  keylime_agent::payloads        &gt; Running script: &quot;/var/lib/keylime/secure/unzipped/autorun.sh&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 11 07:22:12 localhost keylime_agent[1756]:  INFO  keylime_agent::payloads        &gt; No payload script autorun.sh found in /var/lib/keylime/secure/unzipped</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 11 07:22:12 localhost keylime_agent[1756]:  DEBUG keylime_agent::payloads        &gt; Sending PayloadDecrypted message to revocation worker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 11 07:22:12 localhost keylime_agent[1756]:  INFO  keylime_agent::payloads        &gt; Successfully executed encrypted payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 11 07:22:12 localhost keylime_agent[1756]:  INFO  keylime_agent::revocation      &gt; Loading the revocation certificate from /var/lib/keylime/secure/unzipped/RevocationNotifier-cert.crt</span><br></span></code></pre></div></div>
<p>The agent will use that certificate to confirm that the revocation order came from the Keylime tenant and not from an attacker. The agent will also use the revocation script to revoke itself, if any was configured.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Jul 11 07:32:07 localhost keylime_agent[1756]:  INFO  keylime_agent::notifications_handler &gt; Received revocation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jul 11 07:32:07 localhost keylime_agent[1756]:  DEBUG keylime_agent::revocation            &gt; Revocation signature validated for revocation: {&quot;agent_id&quot;:&quot;61388a67-baa4-4f2b-8221-d539b7b4d98b&quot;,&quot;context&quot;:&quot;{\&quot;message\&quot;: \&quot;Hash not found in runtime policy\&quot;, \&quot;got\&quot;: \&quot;97356fb8edc035052bac594306d0fdcef99f28e42703acaafa8d7940868b60d0\&quot;, \&quot;expected\&quot;: [\&quot;046209cb4acb79d533a9c6a9845766d4f435bc059f45421ed6e1cceb9c2dcc2e\&quot;]}&quot;,&quot;event_id&quot;:&quot;ima.validation.ima-ng.runtime_policy_hash&quot;,&quot;event_time&quot;:&quot;Fri Jul 11 09:32:08 2025&quot;,&quot;ip&quot;:&quot;192.168.122.47&quot;,&quot;meta_data&quot;:&quot;{\&quot;cert_serial\&quot;: 4, \&quot;subject\&quot;: \&quot;OU=53,O=MITLL,L=Lexington,ST=MA,CN=61388a67-baa4-4f2b-8221-d539b7b4d98b,C=US\&quot;}&quot;,&quot;port&quot;:9002,&quot;severity_label&quot;:&quot;emergency&quot;,&quot;tpm_policy&quot;:&quot;{\&quot;mask\&quot;: \&quot;0x400\&quot;}&quot;,&quot;type&quot;:&quot;revocation&quot;}</span><br></span></code></pre></div></div>
<p>This is a very basic example of how to use keylime in Kairos. You can extend this to use more complex policies and more complex attestation mechanisms.
As Keylime is a very flexible tool, you can use it in many different ways to secure your infrastructure. Here are some more links to the Keylime documentation to get you started:</p>
<ul>
<li class=""><a href="https://keylime-docs.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer" class="">Keylime documentation</a></li>
<li class=""><a href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/security_hardening/assembly_ensuring-system-integrity-with-keylime_security-hardening" target="_blank" rel="noopener noreferrer" class="">Red Hat Keylime documentation</a></li>
<li class=""><a href="https://documentation.suse.com/sle-micro/6.0/html/Micro-keylime/index.html" target="_blank" rel="noopener noreferrer" class="">Suse Keylime documentation</a></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/kairos-io/kairos-docs/tree/main/versioned_docs/version-3.5.7/Examples/keylime.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-12-07T21:28:02.000Z" itemprop="dateModified">Dec 7, 2025</time></b> by <b>Jasper De Keukelaere (imec)</b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/kairos-docs/docs/3.5.7/Examples/kdump"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Enabling kdump</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/kairos-docs/docs/3.5.7/Examples/kubeadm-provider"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">A Minimal Single-Node Kubernetes with Kubeadm</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#extend-kairos" class="table-of-contents__link toc-highlight">Extend Kairos</a></li><li><a href="#using-a-runtime-policy" class="table-of-contents__link toc-highlight">Using a runtime policy</a></li><li><a href="#using-a-tpm-policy-instead" class="table-of-contents__link toc-highlight">Using a TPM policy instead</a></li><li><a href="#using-revocation-keys" class="table-of-contents__link toc-highlight">Using revocation keys</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/kairos-docs/docs/getting-started">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/kairos-docs/docs/installation">Installation</a></li><li class="footer__item"><a class="footer__link-item" href="/kairos-docs/docs/architecture">Architecture</a></li><li class="footer__item"><a class="footer__link-item" href="/kairos-docs/docs/examples">Examples</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://slack.cncf.io/#kairos" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/kairos-io/kairos/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/kairos-oss/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/Kairos_OSS" target="_blank" rel="noopener noreferrer" class="footer__link-item">X (Twitter)<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/kairos-docs/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/kairos-io/kairos" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.spectrocloud.com/solutions/kairos-support" target="_blank" rel="noopener noreferrer" class="footer__link-item">Commercial Support<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2025 Kairos authors</div></div></div></footer></div>
</body>
</html>