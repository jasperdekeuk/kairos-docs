"use strict";(globalThis.webpackChunkkairos_docs=globalThis.webpackChunkkairos_docs||[]).push([[7395],{28453:(e,t,o)=>{o.d(t,{R:()=>i,x:()=>a});var n=o(96540);const s={},r=n.createContext(s);function i(e){const t=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),n.createElement(r.Provider,{value:t},e.children)}},69841:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>l,frontMatter:()=>i,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"Reference/recovery_mode","title":"Recovery mode","description":"The Kairos recovery mode can be used to recover a damaged system or to regain access remotely (with assistance) to a machine which has been lost access to. The recovery mode is accessible only from the GRUB menu, from both the LiveCD, and an installed system.","source":"@site/versioned_docs/version-3.6.0/Reference/recovery_mode.md","sourceDirName":"Reference","slug":"/Reference/recovery_mode","permalink":"/kairos-docs/docs/3.6.0/Reference/recovery_mode","draft":false,"unlisted":false,"editUrl":"https://github.com/kairos-io/kairos-docs/tree/main/versioned_docs/version-3.6.0/Reference/recovery_mode.md","tags":[],"version":"3.6.0","lastUpdatedBy":"Jasper De Keukelaere (imec)","lastUpdatedAt":1765142882000,"sidebarPosition":7,"frontMatter":{"title":"Recovery mode","sidebar_label":"Recovery mode","sidebar_position":7,"date":"2022-11-13T00:00:00.000Z"},"sidebar":"tutorialSidebar","previous":{"title":"Troubleshooting","permalink":"/kairos-docs/docs/3.6.0/Reference/troubleshooting"},"next":{"title":"Entangle","permalink":"/kairos-docs/docs/3.6.0/Reference/entangle"}}');var s=o(74848),r=o(28453);const i={title:"Recovery mode",sidebar_label:"Recovery mode",sidebar_position:7,date:new Date("2022-11-13T00:00:00.000Z")},a=void 0,c={},d=[{value:"Boot into recovery mode",id:"boot-into-recovery-mode",level:2},{value:"Connect to the machine",id:"connect-to-the-machine",level:2}];function h(e){const t={admonition:"admonition",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"The Kairos recovery mode can be used to recover a damaged system or to regain access remotely (with assistance) to a machine which has been lost access to. The recovery mode is accessible only from the GRUB menu, from both the LiveCD, and an installed system."}),"\n",(0,s.jsx)(t.admonition,{title:"Note",type:"note",children:(0,s.jsx)(t.p,{children:"On installed system, there are two recovery modes available during boot. Below describes only how the Kairos remote recovery works. It can be used to reset the A/B partitions (with the user/pass used during setup) and perform any other operation without remote access."})}),"\n",(0,s.jsx)(t.h2,{id:"boot-into-recovery-mode",children:"Boot into recovery mode"}),"\n",(0,s.jsx)(t.p,{children:"Kairos recovery mode can be accessed either via ISO or from an installed system."}),"\n",(0,s.jsxs)(t.p,{children:["A GRUB menu will be displayed:\n",(0,s.jsx)(t.img,{src:"https://user-images.githubusercontent.com/2420543/165800177-3e4cccd8-f67c-43a2-bd88-329478539400.png",alt:"Screenshot from 2022-04-28 17-48-06"})]}),"\n",(0,s.jsxs)(t.p,{children:["Select the last entry ",(0,s.jsx)(t.code,{children:"kairos (remote recovery mode)"})," and press enter."]}),"\n",(0,s.jsx)(t.p,{children:"At this point the boot process starts, and you should be welcomed by the Kairos screen:"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{src:"https://user-images.githubusercontent.com/2420543/165800182-9aa29c90-09e9-4c53-b3c7-c8ced262e3ac.png",alt:"Screenshot from 2022-04-28 17-48-32"})}),"\n",(0,s.jsx)(t.p,{children:"After few seconds, the recovery process starts, and right after a QR code will be printed out of the screen along with a password which can be used later to SSH into the machine:"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{src:"https://user-images.githubusercontent.com/2420543/165800187-4d2fe04e-c501-4ad8-a29f-32a0110eaa72.png",alt:"Screenshot from 2022-04-28 17-48-43"})}),"\n",(0,s.jsx)(t.p,{children:"At this stage, take a screenshot or a photo and save the image with the QR code."}),"\n",(0,s.jsx)(t.h2,{id:"connect-to-the-machine",children:"Connect to the machine"}),"\n",(0,s.jsx)(t.p,{children:"In the another machine that you are using to connect to your server, (your workstation, a jumpbox, or other) use the Kairos CLI to connect over the remote machine:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"$ ./kairosctl bridge --qr-code-image /path/to/image.png\n INFO   Connecting to service kAIsuqiwKR\n INFO   SSH access password is yTXlkak\n INFO   SSH server reachable at 127.0.0.1:2200\n INFO   To connect, keep this terminal open and run in another terminal 'ssh 127.0.0.1 -p 2200' the password is  yTXlkak\n INFO   Note: the connection might not be available instantly and first attempts will likely fail.\n INFO         Few attempts might be required before establishing a tunnel to the host.\n INFO   Starting EdgeVPN network\n INFO   Node ID: 12D3KooWSTRBCTNGZ61wzK5tgYvFi8rQVxkXJCDUYngBWGDSyoBK\n INFO   Node Addresses: [/ip4/192.168.1.233/tcp/36071 /ip4/127.0.0.1/tcp/36071 /ip6/::1/tcp/37661]\n INFO   Bootstrapping DHT\n"})}),"\n",(0,s.jsxs)(t.p,{children:["At this point, the bridge should start, and you should be able to see connection messages in the terminal. You can connect to the remote machine by using ",(0,s.jsx)(t.code,{children:"ssh"})," and pointing it locally at ",(0,s.jsx)(t.code,{children:"127.0.0.1:2200"}),". The username is not relevant, the password is print from the CLI."]}),"\n",(0,s.jsx)(t.p,{children:"The bridge operates in the foreground, so you have to shut it down by using CTRL-C."})]})}function l(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);