"use strict";(globalThis.webpackChunkkairos_docs=globalThis.webpackChunkkairos_docs||[]).push([[3873],{21300:(e,a,s)=>{s.r(a),s.d(a,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"Upgrade/manual","title":"Manual Upgrades","description":"Learn how to manually upgrade Kairos Active and Recovery images","source":"@site/versioned_docs/version-3.5.7/Upgrade/manual.md","sourceDirName":"Upgrade","slug":"/Upgrade/manual","permalink":"/docs/3.5.7/Upgrade/manual","draft":false,"unlisted":false,"editUrl":"https://github.com/kairos-io/kairos-docs/tree/main/versioned_docs/version-3.5.7/Upgrade/manual.md","tags":[],"version":"3.5.7","lastUpdatedBy":"Jasper De Keukelaere (imec)","lastUpdatedAt":1765142882000,"sidebarPosition":1,"frontMatter":{"title":"Manual Upgrades","sidebar_label":"Manual","sidebar_position":1,"date":"2022-11-13T00:00:00.000Z","description":"Learn how to manually upgrade Kairos Active and Recovery images"},"sidebar":"tutorialSidebar","previous":{"title":"Upgrade","permalink":"/docs/3.5.7/category/upgrade"},"next":{"title":"From Kubernetes","permalink":"/docs/3.5.7/Upgrade/kubernetes"}}');var i=s(74848),n=s(28453);const r={title:"Manual Upgrades",sidebar_label:"Manual",sidebar_position:1,date:new Date("2022-11-13T00:00:00.000Z"),description:"Learn how to manually upgrade Kairos Active and Recovery images"},o=void 0,d={},l=[{value:"Listing available versions",id:"listing-available-versions",level:2},{value:"Upgrading the active system",id:"upgrading-the-active-system",level:2},{value:"Upgrading the recovery system",id:"upgrading-the-recovery-system",level:2},{value:"What about the passive system?",id:"what-about-the-passive-system",level:2},{value:"Upgrading single entries (trusted boot installations)",id:"upgrading-single-entries-trusted-boot-installations",level:2}];function c(e){const a={a:"a",admonition:"admonition",code:"code",h2:"h2",p:"p",pre:"pre",...(0,n.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.p,{children:"Upgrades can be run manually from the terminal."}),"\n",(0,i.jsxs)(a.p,{children:["Kairos images are released on ",(0,i.jsx)(a.a,{href:"https://quay.io/organization/kairos",children:"quay.io"}),"."]}),"\n",(0,i.jsx)(a.admonition,{title:"Note",type:"note",children:(0,i.jsxs)(a.p,{children:["Looking to upgrade from a private registry OCI image? Check the ",(0,i.jsx)(a.a,{href:"../../Advanced/private_registry_auth",children:"Private registry auth"})," page."]})}),"\n",(0,i.jsx)(a.h2,{id:"listing-available-versions",children:"Listing available versions"}),"\n",(0,i.jsx)(a.p,{children:"Using the agent, you can list all the available versions to upgrade to."}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"$ sudo kairos-agent upgrade list-releases\nv0.57.0\nv0.57.0-rc2\nv0.57.0-rc1\nv0.57.0-alpha2\nv0.57.0-alpha1\n"})}),"\n",(0,i.jsx)(a.h2,{id:"upgrading-the-active-system",children:"Upgrading the active system"}),"\n",(0,i.jsxs)(a.p,{children:["To specify an image, use the ",(0,i.jsx)(a.code,{children:"--source"})," flag:"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"sudo kairos-agent upgrade --source <type>:<address>\n"})}),"\n",(0,i.jsxs)(a.p,{children:["Where type can be ",(0,i.jsx)(a.code,{children:"dir"})," or ",(0,i.jsx)(a.code,{children:"oci"})," and address is the path to the directory in the ",(0,i.jsx)(a.code,{children:"dir"})," case or the ",(0,i.jsx)(a.code,{children:"<repo/image:tag>"})," combination in the ",(0,i.jsx)(a.code,{children:"oci"})," case."]}),"\n",(0,i.jsx)(a.p,{children:"For example, if you wanted to upgrade to the latest available stable release you could run the following command:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"sudo kairos-agent upgrade --source oci:quay.io/kairos/kairos-standard:latest\n"})}),"\n",(0,i.jsx)(a.p,{children:"Once you have tested the new system and are happy with it, you can upgrade the recovery system."}),"\n",(0,i.jsx)(a.h2,{id:"upgrading-the-recovery-system",children:"Upgrading the recovery system"}),"\n",(0,i.jsx)(a.p,{children:"The recovery system is there for a reason, to help you recover the active system in case of failure. This is why we don't allow upgrading the active system and recovery one at the same time and it needs to be done in a separate step. It's advised to also upgrade the recovery system often, to keep it close to the active one. This will make sure you have a familiar system to work with, when you boot to the recovery system instead of an old image you haven't used for quite a long time."}),"\n",(0,i.jsx)(a.admonition,{title:"Warning",type:"warning",children:(0,i.jsx)(a.p,{children:"Only upgrade the recovery system, when you are sure that the active system is running correctly."})}),"\n",(0,i.jsx)(a.p,{children:"To make this process less error prone, the upgrade command provides an extra flag that will upgrade the recovery only. It uses the same system and flags as the normal upgrade."}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"sudo kairos-agent upgrade --recovery --source oci:quay.io/kairos/kairos-standard:latest\n"})}),"\n",(0,i.jsx)(a.h2,{id:"what-about-the-passive-system",children:"What about the passive system?"}),"\n",(0,i.jsx)(a.p,{children:"The passive system is the one that is not running. It is not possible to upgrade it directly. The passive system will be upgraded when the active system is rebooted."}),"\n",(0,i.jsx)(a.h2,{id:"upgrading-single-entries-trusted-boot-installations",children:"Upgrading single entries (trusted boot installations)"}),"\n",(0,i.jsxs)(a.p,{children:["On systems installed in ",(0,i.jsx)(a.a,{href:"../../Architecture/trustedboot/",children:'"trusted boot" mode'}),", it's not possible to edit the cmdline\nwithout generating a new bootable image because the cmdline is part of the signed artifact.\nFor this reason, custom cmdlines are generated as separate artifacts at build time.\nBeing different artifacts though, means that they will need to be upgraded too."]}),"\n",(0,i.jsxs)(a.p,{children:["This can be achieved by passing the name of the ",(0,i.jsx)(a.code,{children:"efi"})," file (without the extension) to the upgrade command like this:"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"kairos-agent upgrade --source oci:quay.io/kairos/kairos-standard:latest --boot-entry <efi_file_name_here>\n"})}),"\n",(0,i.jsx)(a.p,{children:"You can find the efi file name by listing all the efi files in the installed system:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"ls /efi/EFI/kairos/*.efi\n"})})]})}function h(e={}){const{wrapper:a}={...(0,n.R)(),...e.components};return a?(0,i.jsx)(a,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},28453:(e,a,s)=>{s.d(a,{R:()=>r,x:()=>o});var t=s(96540);const i={},n=t.createContext(i);function r(e){const a=t.useContext(n);return t.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function o(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(n.Provider,{value:a},e.children)}}}]);