"use strict";(globalThis.webpackChunkkairos_docs=globalThis.webpackChunkkairos_docs||[]).push([[4947],{28453:(e,t,r)=>{r.d(t,{R:()=>a,x:()=>i});var o=r(96540);const n={},s=o.createContext(n);function a(e){const t=o.useContext(s);return o.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),o.createElement(s.Provider,{value:t},e.children)}},33239:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>d,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"Upgrade/system-upgrade-controller","title":"Installing system-upgrade-controller (Deprecated)","description":"Install the system-upgrade-controller (deprecated - use Kairos operator instead)","source":"@site/docs/Upgrade/system-upgrade-controller.md","sourceDirName":"Upgrade","slug":"/Upgrade/system-upgrade-controller","permalink":"/docs/next/Upgrade/system-upgrade-controller","draft":false,"unlisted":false,"editUrl":"https://github.com/kairos-io/kairos-docs/tree/main/docs/Upgrade/system-upgrade-controller.md","tags":[],"version":"current","lastUpdatedBy":"Jasper De Keukelaere (imec)","lastUpdatedAt":1765043763000,"sidebarPosition":4,"frontMatter":{"title":"Installing system-upgrade-controller (Deprecated)","sidebar_label":"System Upgrade Controller (Deprecated)","sidebar_position":4,"date":"2024-10-02T00:00:00.000Z","description":"Install the system-upgrade-controller (deprecated - use Kairos operator instead)"},"sidebar":"tutorialSidebar","previous":{"title":"Kairos Operator","permalink":"/docs/next/Upgrade/kairos-operator"},"next":{"title":"Trusted Boot","permalink":"/docs/next/Upgrade/trustedboot"}}');var n=r(74848),s=r(28453);const a={title:"Installing system-upgrade-controller (Deprecated)",sidebar_label:"System Upgrade Controller (Deprecated)",sidebar_position:4,date:new Date("2024-10-02T00:00:00.000Z"),description:"Install the system-upgrade-controller (deprecated - use Kairos operator instead)"},i=void 0,d={},c=[];function l(e){const t={a:"a",admonition:"admonition",code:"code",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.admonition,{title:"Deprecated",type:"warning",children:(0,n.jsxs)(t.p,{children:["The system-upgrade-controller approach is deprecated. We recommend using the ",(0,n.jsx)(t.a,{href:".././kairos-operator",children:"Kairos operator"})," instead, which provides a more integrated and Kairos-specific way to manage upgrades and operations."]})}),"\n",(0,n.jsxs)(t.p,{children:["To upgrade Kairos with Kubernetes using the legacy approach, it is necessary to have ",(0,n.jsx)(t.a,{href:"https://github.com/rancher/system-upgrade-controller",children:"system-upgrade-controller"})," deployed on the target cluster."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.a,{href:"https://github.com/rancher/system-upgrade-controller#deploying",children:"The upstream documentation"})," on how to install the system-upgrade-controller, is this command:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"kubectl apply -k github.com/rancher/system-upgrade-controller\n"})}),"\n",(0,n.jsxs)(t.p,{children:["This command requires the ",(0,n.jsx)(t.code,{children:"git"})," command to be available in order to clone the remote repository. Kairos images, generally, don't include git. You will need to run this command from a machine which has ",(0,n.jsx)(t.code,{children:"git"})," available and access to the cluster with a valid KUBECONFIG file."]}),"\n",(0,n.jsxs)(t.p,{children:["Alternatively, from withing the Kairos node, you can deploy the following ",(0,n.jsx)(t.code,{children:"Job"})," which will clone the system-upgrade controller repository to the ",(0,n.jsx)(t.code,{children:"/home/kairos"})," directory:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:'apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: git\nspec:\n  template:\n    spec:\n      restartPolicy: Never\n      containers:\n        - name: git\n          image: alpine/git\n          command: ["git", "clone", "--branch", "latest", "https://github.com/rancher/system-upgrade-controller", "/homedir/system-upgrade-controller"]\n          volumeMounts:\n            - name: homedir\n              mountPath: /homedir\n      volumes:\n        - name: homedir\n          hostPath:\n            path: /home/kairos\n            type: Directory\n'})}),"\n",(0,n.jsx)(t.p,{children:"(make sure you checkout the desired branch/release)"}),"\n",(0,n.jsxs)(t.p,{children:["Then, from the ",(0,n.jsx)(t.code,{children:"/home/kairos"})," directory, you can run this command to deploy the system-upgrade-controller:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"kubectl apply -k system-upgrade-controller\n"})})]})}function p(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}}}]);